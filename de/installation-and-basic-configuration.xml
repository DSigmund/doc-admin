<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
  "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">

<chapter id="installation">
<title>Installation</title>

<abstract>
<para>
Dieser Abschnitt beschreibt die Installation und die grundlegende
Einrichtung des zentralen OTRS Frameworks. Dabei wird die Installation von
OTRS aus dem Quellcode erläutert, wie auch über Binärpakete wie RPM oder
ausführbare Dateien für Windows.
</para>

<para>
Dieses Kapitel beschreibt die Einrichtung des Web- und Datenbankservers, die
Schnittstelle zwischen OTRS und der Datenbank, das Einspielen einzelner
Perl-Module, das Setzen der richtigen Berechtigungen, die Einrichtung der
OTRS-eigenen cron-Jobs sowie grundlegende Einstellungen in den
OTRS-Konfigurationsdateien.
</para>

<para>
Folgen Sie den Schritten in diesem Kapitel, um OTRS auf Ihrem Server zu
installieren. Dann können Sie sich über die Weboberfläche anmelden und das
System administrieren.
</para>
</abstract>

<section id="installation-of-prepared-packages">
<title>Der einfache Weg - Installation fertiger Pakete</title>

<para>
Der einfachste und komfortableste Weg ein lauffähiges OTRS zu installieren
ist sicherlich, auf bereits vorgefertigte Pakete zurück zu greifen. Viele
bereits vorgefertigte Installations-Pakete sind im Download-Bereich unter
<ulink
url="http://www.otrs.org"><citetitle>http://www.otrs.org</citetitle></ulink>
zu finden. Da der Aufwand viel zu groß wäre, die Installation aller dort
aufgeführten Pakete in dieser Dokumentation anzuführen, soll im Folgenden
nur näher auf die Installation von OTRS unter SUSE Linux, Debian und
Microsoft Windows eingegangen werden. Sehen Sie unter der o.g. URL nach, ob
auch für Ihr Betriebssystem ein fertiges Installations-Paket vorhanden ist
und greifen Sie nur auf die manuelle Installation zurück, wenn Sie keine
andere Möglichkeit haben.
</para>

<section id="installation-on-suse">
<title>Installation des RPM auf einem SuSE-Linux-Server</title>

<para>
Dieser Abschnitt beinhaltet die Anleitung für die Installation von OTRS
unter SUSE Linux. Getestet wurden die Versionen auf allen aktuellen
Versionen von SLES und OpenSUSE. Bevor Sie mit der Installation beginnen,
sehen Sie bitte unter <ulink
url="http://www.otrs.com/try/"><citetitle>http://www.otrs.com/try/</citetitle></ulink>
nach, ob eine aktuellere Version von OTRS als .rpm-Datei vorliegt. Sollte
dies der Fall sein, verwenden Sie bitte diese neuere Version.
</para>

<para>
Installieren Sie OTRS mittels <application>yast</application> (yast2) oder
der Kommandozeile und <command>rpm</command>, je nach Vorliebe. Beachten Sie
jedoch, dass OTRS einige Perl-Module benötigt, die nicht standardmäßig in
einer typischen SUSE-Installation enthalten
sind. <application>yast</application> sollte die bessere Wahl sein, da es
alle Abhängikeiten automatisch beachtet und auflösen kann.
</para>

<para>
Sollten Sie den Weg über die Kommandozeile mit <command>rpm</command>
bevorzugen, so müssen Sie die Perl-Module manuell vor Beginn der
Installation von OTRS installieren. Angenommen Sie haben die Datei
<filename>otrs.rpm</filename> im Verzeichnis <filename>/tmp</filename>
gespeichert, dann geben Sie zur Installation von OTRS folgenden Befehl ein.
</para>

<para>
Hinweis: Wenn Sie es auf SLES9 oder OES installieren, dann folgen Sie bitte
dieser Anleitung, um die fehlenden perl-GD Pakete zu installieren:
http://faq.otrs.org/otrs/public.pl?FAQID=49.
</para>

<para>
<screen>
linux:~ # rpm -i /tmp/otrs-xxx.rpm
otrs                        ##################################################
Check OTRS user (/etc/passwd)... otrs exists.

Next steps:

[SuSEconfig]
 Execute 'SuSEconfig' to configure the web server.

[start Apache and MySQL]
 Execute 'rcapache restart' and 'rcmysql start' in case they don't run.

[install the OTRS database]
 Use a web browser and open this link:
 http://localhost/otrs/installer.pl

[OTRS services]
 Start OTRS 'rcotrs start-force' (rcotrs {start|stop|status|restart|start-force|stop-force}).

Have fun!

 Your OTRS Team
 http://otrs.org/

linux:~ #
</screen>
</para>

<para>
<emphasis>Skript 3.1. Kommando für die Installation von OTRS.</emphasis>
</para>

<para>
Nach der Installation des rpm's ist es notwendig,
<application>SuSEconfig</application> zu starten. Geben Sie hierzu Folgendes
ein.
</para>

<para>
<screen>
linux:~ # SuSEconfig
Starting SuSEconfig, the SuSE Configuration Tool...
Running in full featured mode.
Reading /etc/sysconfig and updating the system...
Executing /sbin/conf.d/SuSEconfig.aaa_at_first...
Executing /sbin/conf.d/SuSEconfig.apache...
Including /opt/otrs/scripts/apache-httpd.include.conf
Executing /sbin/conf.d/SuSEconfig.bootsplash...
Executing /sbin/conf.d/SuSEconfig.doublecheck...
Executing /sbin/conf.d/SuSEconfig.guile...
Executing /sbin/conf.d/SuSEconfig.hostname...
Executing /sbin/conf.d/SuSEconfig.ispell...
Executing /sbin/conf.d/SuSEconfig.perl...
Executing /sbin/conf.d/SuSEconfig.permissions...
Executing /sbin/conf.d/SuSEconfig.postfix...
Setting up postfix local as MDA...
Setting SPAM protection to "off"...
Executing /sbin/conf.d/SuSEconfig.profiles...
Finished.
linux:~ #
</screen>
</para>

<para>
<emphasis>Skript 3.2. Ausführung des Kommandos SuSEconfig.</emphasis>
</para>

<para>
Die Installation des OTRS-rpm ist abgeschlossen. Starten Sie nun Ihren
Webserver neu, um die Änderungen in der Konfiguration zu übernehmen.
</para>

<para>
<screen>
linux:~ # rcapache restart
Shutting down httpd                                         done
Starting httpd [ PERL ]                                     done
linux:~ #
</screen>
</para>

<para>
<emphasis>Skript 3.3. Neustart des Webservers.</emphasis>
</para>

<para>
Der nächste Schritt ist das Aufsetzen der Datenbank wie in <link
linkend="database-configuration"> dem Abschnitt über die
Datenbankkonfiguration  </link> beschrieben.
</para>

</section>

<section id="installation-on-debian">
<title>Installing OTRS on a Debian or Ubuntu system</title>
<important>
    <para>
        Please install OTRS <link linkend="manual-installation-of-otrs">from
source</link>, and do not use the OTRS packages that Debian/Ubuntu provides.
    </para>
</important>
<para>
    The installation of required Perl modules is easier if you use the available
packages: <screen>
apt-get install libapache2-mod-perl2 libdbd-mysql-perl libtimedate-perl libnet-dns-perl \
    libnet-ldap-perl libio-socket-ssl-perl libpdf-api2-perl libdbd-mysql-perl libsoap-lite-perl \
    libgd-text-perl libtext-csv-xs-perl libjson-xs-perl libgd-graph-perl libapache-dbi-perl
    </screen>
</para>
</section>

<section id="installation-on-windows">
<title>Installation von OTRS auf Microsoft Windows-Systemen</title>

<para>
Die Installation von OTRS unter Microsoft Windows ist denkbar einfach. Laden
Sie den auf <ulink
url="http://www.otrs.com/try/"><citetitle>http://www.otrs.com/try/</citetitle></ulink>
bereit gestellten Installer herunter und speichern Sie die
Datei. Anschließend führen Sie den Installer einfach aus und folgen den
einzelnen Installationsschritten. Danach können Sie sich als
OTRS-Administrator am System anmelden und dieses weiter konfigurieren. Um
sich als Administrator anzumelden, verwenden Sie den Benutzernamen
'root@localhost' und das voreingestellte Passwort 'root'.
</para>

<warning>
<para>
Bitte ändern Sie das Passwort für den Benutzer 'root@localhost' umgehend.
</para>
</warning>

<important>
<para>
Der Windows-Installer für OTRS beinhaltet bereits alle Komponenten, die für
den Betrieb von OTRS benötigt werden. D.h., es wird zusätzlich zum
eigentlichen OTRS der <application>apache2</application> Webserver,
<application>MySQL</application>, <application>Perl</application> mit den
für OTRS benötigten Modulen und<application>cron</application> für Windows
installiert. Aus diesem Grund ist es empfehlenswert OTRS über den Installer
nur auf solchen Windowssystemen zu installieren, auf denen noch kein
<application>apache2</application> bzw. ein anderer Webserver und kein
<application>MySQL</application> läuft.
</para>
</important>

</section>

</section>

<section id="manual-installation-of-otrs">
<title>Manuelle Installation (Linux, Unix)</title>

<section id="preparing-manual-installation">
<title>Vorbereiten der manuellen Installation</title>

<para>
Wenn Sie OTRS manuell über die Quellen installieren möchten oder müssen,
laden Sie sich zuerst das aktuelle Archiv herunter. Sie finden die
entsprechenden .tar.gz- oder .tar.bz2-Dateien im Downloadbereich auf <ulink
url="http://www.otrs.com/try/"><citetitle>http://www.otrs.com/try/</citetitle></ulink>.
</para>

<para>
Entpacken Sie das Archiv mit Hilfe von <command>tar</command> z. B. in das
Verzeichnis <filename>/opt</filename> und benennen Sie das entpackte
Verzeichnis von 'otrs-3.0.x' in 'otrs' um:
</para>

<para>
<screen>
linux:/opt# tar xf /tmp/otrs-3.0.tar.gz
linux:/opt# mv otrs-3.0 otrs
linux:/opt# ls
otrs
linux:/opt#
</screen>
</para>

<para>
<emphasis>Skript 3.4. Erste Schritte bei der Installation von
OTRS.</emphasis>
</para>

<para>
Da die Skripte von OTRS später nicht mit root-Rechten laufen sollen, muss im
nächsten Schritt ein Benutzer für OTRS im System angelegt werden. Dieser
Benutzer sollte als Homeverzeichnis das Verzeichnis erhalten, in das gerade
die Quellen von OTRS entpackt wurden,
also<filename>/opt/otrs</filename>. Wird der Webserver unter einem anderen
Benutzer als dem OTRS-User betrieben, so muss der neue OTRS-Benutzer noch
zur Gruppe des Webserver-Users hinzugefügt werden.
</para>

<para>
<screen>
linux:/opt# useradd -r -d /opt/otrs/ -c 'OTRS user' otrs
linux:/opt# usermod -G nogroup otrs
linux:/opt#
</screen>
</para>

<para>
<emphasis>Skript 3.5. Anlegen eines neuen Nutzers 'otrs' und Hinzufügung zu
desselben zu einer Gruppe.</emphasis>
</para>

<para>
Im nächsten Schritt werden einige Demo-Konfigurationsdateien innerhalb der
entpackten Quelldateien bzw. innerhalb des Homeverzeichnisses des
OTRS-Benutzers kopiert. Die Dateien befinden sich in den Verzeichnissen
<filename>/opt/otrs/Kernel</filename>
bzw. <filename>/opt/otrs/Kernel/Config</filename> und haben die Endung
.dist.
</para>

<para>
<screen>
linux:/opt# cd otrs/Kernel/
linux:/opt/otrs/Kernel# cp Config.pm.dist Config.pm
linux:/opt/otrs/Kernel# cd Config
linux:/opt/otrs/Kernel/Config# cp GenericAgent.pm.dist GenericAgent.pm
</screen>
</para>

<para>
<emphasis>Skript 3.6. Kopieren von Beispieldateien.</emphasis>
</para>

<para>
Zum Abschluss der Vorbereitungen werden noch die richtigen Zugriffsrechte
für die Dateien des Ticket Systems gesetzt. Dazu kann das Skript
<command>SetPermissions.sh</command> verwendet werden, das sich im
Verzeichnis <filename>bin</filename> innerhalb des Homeverzeichnisses des
OTRS-Benutzers befindet. Das Skript kann mit folgenden Parametern aufgerufen
werden:
</para>

<para>
<cmdsynopsis>
<command>otrs.SetPermissions.pl</command>    <arg choice='req'>
<replaceable>Homedirectory des OTRS Benutzers</replaceable>    </arg>
<arg choice='req'>      <replaceable>OTRS Benutzer</replaceable>    </arg>
<arg choice='req'>      <replaceable>Webserver Benutzer</replaceable>
</arg>    <arg choice='opt'>      <replaceable>Gruppe des OTRS
Benutzers</replaceable>    </arg>    <arg choice='opt'>
<replaceable>Gruppe des Webserver Benutzers</replaceable>    </arg></cmdsynopsis>
</para>

<para>
Läuft Ihr Webserver mit den Benutzerrechten des Benutzers 'otrs', dann
lautet das Kommando also<command>otrs.SetPermissions.pl /opt/otrs
--otrs-user=otrs --web-user=otrs</command>. Unter SUSE Linux wird der
Webserver mit dem Benutzer wwwrun betrieben. Auf Debian-basierten Systemen
ist dies www-data. Geben Sie hier das Komando
<command>otrs.SetPermissions.pl /opt/otrs --otrs-user=otrs --web-user=wwwrun
--otrs-group=nogroup --web-group=www</command> ein, um die korrekten
Zugriffsrechte zu setzen.
</para>

</section>

<section id="installation-of-perl-modules">
<title>Installation der für OTRS benötigten Perl-Module</title>

<para>
Für den Betrieb von OTRS werden einige Perl-Module benötigt. Wenn Sie OTRS
manuell einrichten, müssen Sie wahrscheinlich einige dieser Module per Hand
nachinstallieren. Dies können Sie entweder über den Paketmanager ihrer
Distribution erledigen (<application>yast</application>,
<application>apt-get</application>), oder, wie in diesem Kapitel
beschrieben,  direkt über die Shell von <application>Perl</application> und
CPAN. Wir empfehlen die Verwendung des Paketmanagers, wenn möglich.
</para>

<para>

<table id="table-of-needed-perl-modules">
<title>Die folgenden Perl-Module werden von OTRS benötigt.</title>
  <tgroup cols="2">
    <thead>
      <row>
        <entry>
          Name
        </entry>
        <entry>
          Beschreibung
        </entry>
      </row>
    </thead>
    <tbody>
      <row>
        <entry>
          DBI
        </entry>
        <entry>
          Dieses Modul wird von OTRS für die Verbindung zum Datenbank-Backend
benötigt.
        </entry>
      </row>
      <row>
        <entry>
          DBD::mysql
        </entry>
        <entry>
          Modul zum Verbindungsaufbau zum MySQL-Datenbank-Backend (nur benötigt bei
Verwendung von MySQL).
        </entry>
      </row>
      <row>
        <entry>
          DBD::pg
        </entry>
        <entry>
          Modul zum Verbindungsaufbau zum PostgreSQL-Datenbank-Backend (nur benötigt
bei Verwendung von PostgreSQL).
        </entry>
      </row>
      <row>
        <entry>
          Digest::MD5
        </entry>
        <entry>
          Ermöglicht die Verwendung des md5-Algorithmus.
        </entry>
      </row>
      <row>
        <entry>
          CSS::Minifier
        </entry>
        <entry>
          Komprimiert eine CSS-Datei und schreibt das Ergebnis in eine andere Datei.
        </entry>
      </row>
      <row>
        <entry>
          Crypt::PasswdMD5
        </entry>
        <entry>
          Stellt MD5-basierte kryptographische Funktionen bereit.
        </entry>
      </row>
      <row>
        <entry>
          MIME::Base64
        </entry>
        <entry>
          Kodiert / dekodiert Zeichenketten in Base64, z. B. für E-Mail-Anhänge.
        </entry>
      </row>
      <row>
        <entry>
          JavaScript:Minifier
        </entry>
        <entry>
          Komprimiert eine JavaScript-Datei und schreibt das Ergebnis in eine andere
Datei.
        </entry>
      </row>
      <row>
        <entry>
          Net::DNS
        </entry>
        <entry>
          Perl-Interface zum DNS-System.
        </entry>
      </row>
      <row>
        <entry>
          LWP::UserAgent
        </entry>
        <entry>
          Verarbeitet HTTP-Anfragen.
        </entry>
      </row>
      <row>
        <entry>
          Net::LDAP
        </entry>
        <entry>
          LDAP-Schnittstelle für Perl (nur benötigt, wenn LDAP verwendet wird).
        </entry>
      </row>
      <row>
        <entry>
          GD
        </entry>
        <entry>
          Schnittstelle zur Gd Graphics Library. Wird nur benötigt, wenn das
Statistikmodul von OTRS verwendet werden soll.
        </entry>
      </row>
      <row>
        <entry>
          GD::Text, GD::Graph, GD::Graph::lines, GD::Text::Align
        </entry>
        <entry>
          Text- und Grafikwerkzeuge für die Benutzung zusammen mit der GD Graphics
Library. Diese Komponenten werden nur benötigt, wenn das Statistikmodul von
OTRS verwendet werden soll.
        </entry>
      </row>
      <row>
        <entry>
          PDF::API2, Compress::Zlib
        </entry>
        <entry>
          Diese Module werden für die Generierung der PDF-Ausgaben von Statistiken,
Suchergebnissen oder Druckansicht eines Tickets benötigt.
        </entry>
      </row>
    </tbody>
  </tgroup>
</table>

</para>

<para>
Sie können herausfinden, welche Module noch zu installieren sind, indem Sie
das Skript <command>otrs.checkModules</command> verwenden. Das Skript finden
sie im Verzeichnis <filename>bin</filename> innerhalb des Homeverzeichnisses
des Benutzers 'otrs'.
</para>

<para>
Beachten Sie, dass einige Module optional sind.
</para>

<para>
<screen>
linux:~# cd /opt/otrs/bin/
linux:/opt/otrs/bin# ./otrs.CheckModules.pl
   o CGI............................ok (v3.49)
   o Crypt::PasswdMD5...............ok (v1.3)
   o CSS::Minifier..................ok (v0.01)
   o Date::Format...................ok (v2.24)
   o Date::Pcalc....................ok (v1.2)
   o DBI............................ok (v1.609)
   o DBD::mysql.....................ok (v4.013)
   o Digest::MD5....................ok (v2.36_01)
   o Encode::HanExtra...............ok (v0.23)
   o GD.............................ok (v2.44)
      o GD::Text....................ok (v0.86)
      o GD::Graph...................ok (v1.44)
      o GD::Graph::lines............ok (v1.15)
      o GD::Text::Align.............ok (v1.18)
   o IO::Scalar.....................ok (v2.110)
   o IO::Wrap.......................ok (v2.110)
   o JavaScript::Minifier...........ok (v1.05)
   o JSON...........................ok (v2.21)
      o JSON::PP....................ok (v2.27003)
      o JSON::XS....................Not installed! (Optional - Install it for faster AJAX/JavaScript handling.)
   o LWP::UserAgent.................ok (v5.829)
   o Mail::Internet.................ok (v2.06)
   o Mail::POP3Client...............ok (v2.18 )
      o IO::Socket::SSL.............ok (v1.31)
   o MIME::Base64...................ok (v3.07_01)
   o MIME::Tools....................ok (v5.428)
   o Net::DNS.......................ok (v0.65)
   o Net::POP3......................ok (v2.29)
   o Net::IMAP::Simple..............ok (v1.1916)
      o Net::IMAP::Simple::SSL......ok (v1.3)
   o Net::SMTP......................ok (v2.31)
      o Authen::SASL................ok (v2.15)
      o Net::SMTP::SSL..............ok (v1.01)
   o Net::LDAP......................ok (v0.4001)
   o PDF::API2......................ok (v0.73)
      o Compress::Zlib..............ok (v2.008)
   o SOAP::Lite.....................ok (v0.712)
   o Text::CSV......................ok (v1.18)
      o Text::CSV_PP................ok (v1.26)
      o Text::CSV_XS................Not installed! (Optional - Optional, install it for faster CSV handling.)
   o XML::Parser....................ok (v2.36)
linux:/opt/otrs/bin#
</screen>
</para>

<para>
<emphasis>Skript 3.7. Überprüfung benötigter Module.</emphasis>
</para>

<para>
Wenn möglich, sollten Sie die fehlenden Module über das Paketsystem Ihrer
Linux-Distribution installieren. Dadurch werden die Pakete automatisch
aktualisiert, wenn neue Versionen verfügbar sind oder Sicherheitslücken
geschlossen wurden. Bitte schauen Sie dazu in die Dokumentation Ihrer
Distribution. Wenn ihr Paket nicht (in der korrekten Version) im Paketsystem
nicht verfügbar ist, können Sie es über das CPAN installeren, das
Comprehensive Perl Archive Network.
</para>

<para>
Um eines der oben aufgeführten Module mit Hilfe von CPAN zu installieren,
geben Sie als root das Kommando <command>perl -e shell -MCPAN</command>
ein. Perl wird im interaktiven Modus gestartet und das CPAN Modul wird
geladen. Ist CPAN bereits ordentlich konfiguriert, können Sie die für OTRS
benötigten Module mit Hilfe des Kommandos <command>install</command> gefolgt
vom Modulnamen einrichten. CPAN weist darauf hin, wenn Abhängigkeiten
zwischen einzelnen Modulen nicht erfüllt sind und schlägt automatisch die
zusätzlich benötigten Module für die Installation vor.
</para>

<para>
Führen Sie weiterhin die beiden Befehle <command>perl -cw
bin/cgi-bin/index.pl</command> und <command>perl -cw
bin/PostMaster.pl</command> aus, nach dem Sie in das Verzeichnis
<filename>/opt/otrs</filename> gewechselt sind. Wird bei beiden Befehlen die
Meldung "syntax OK" angezeigt, verfügt Ihre Perl-Installation über alle von
OTRS benötigten Module und Sie können im nächsten Schritt mit der
Einrichtung des Webservers beginnen.
</para>

<para>
<screen>
linux:~# cd /opt/otrs
linux:/opt/otrs# perl -cw bin/cgi-bin/index.pl
cgi-bin/installer.pl syntax OK
linux:/opt/otrs# perl -cw bin/otrs.PostMaster.pl
otrs.PostMaster.pl syntax OK
linux:/opt/otrs#
</screen>
</para>

<para>
<emphasis>Skript 3.8. Syntaxprüfung.</emphasis>
</para>

</section>

<section id="web-server-configuration">
<title>Konfiguration des Apache-Webservers</title>

<para>
In diesem Abschnitt wird beschrieben, wie der
<application>Apache</application>-Webserver grundlegend für OTRS
eingerichtet werden muss. Der Webserver sollte cgi- bzw. Perl-Skripte
ausführen können, andernfalls ist kein Betrieb von OTRS möglich. Überprüfen
Sie die Konfigurationsdateien Ihres Webservers und stellen Sie fest, ob das
cgi-Modul geladen wird: Wenn Ihr Webserver die Ausführung von cgi-Skripten
unterstützt, sollte eine Zeile ähnlich der folgenden zu finden sein.
</para>

<para>
LoadModule cgi_module /usr/lib/apache2/modules/mod_cgi.so
</para>

<para>
Um die Oberfläche von OTRS bequem erreichen zu können, wird ein Alias- und
ein ScriptAlias-Eintrag angelegt. Für die meisten Installationen des
<application>apache</application> Webservers gilt, dass ein Verzeichnis mit
dem Namen <filename>conf.d</filename> vorhanden ist, unter Linux ist es
meist unterhalb des Verzeichnisses<filename>/etc/apache</filename>
bzw. <filename>/etc/apache2</filename> zu finden. Wechseln Sie als root in
dieses Verzeichnis und kopieren Sie die passende Konfigurationsvorlage in
<filename>/opt/otrs/scripts/apache2-httpd.include.conf</filename> in die
Datei <filename>otrs.conf</filename>.
</para>

<para>
Starten Sie Ihren Webserver neu, um die neue Konfiguration zu laden. Auf den
meisten Systemen lässt sich der Webserver über den Befehl
<command>/etc/init.d/apache2 restart</command> neu starten.
</para>

<para>
<screen>
linux:/etc/apache2/conf.d# /etc/init.d/apache2 restart
Forcing reload of web server: Apache2.
linux:/etc/apache2/conf.d#
</screen>
</para>

<para>
<emphasis>Skript 3.11. Neustart des Webservers.</emphasis>
</para>

<para>
Das war bereits die grundlegende Konfiguration des Webservers für OTRS.
</para>

<para>
Zur Verbesserung der Performance können sie mod_cgi deaktivieren und den
<application>Apache</application>-Webserver stattdessen für die Benutzung
von mod_perl konfigurieren.
</para>

<para>
Stellen Sie bitte sicher, daß mod_perl installiert und geladen
ist. Andernfalls wird der Webserver-Dienst trotzdem starten, in diesem Fall
wird jedoch mod_cgi verwendet, wenn es noch aktiviert ist (Deaktivierung
wird empfohlen).
</para>

<para>
Suchen Sie im Verzeichnis /etc/apache* nach mod_perl.so (siehe Skript 3.12
unten) um herauszufinden, ob es bereits geladen wird, oder nicht.
</para>

<para>
<screen> #:/ grep -Rn mod_perl.so /etc/apache*</screen>
</para>

<para>
<emphasis>Skript 3.12. Suche nach mod_perl.</emphasis>
</para>

<para>
Wenn Sie das o. a.  geeignete Startskipt verwenden, und mod_perl geladen
wird, kann das Skript /opt/otrs/scripts/apache2-perl-startup.pl verwendet
werden, um die Perl-Module bereits beim Start des Webservers einmalig
vorzuladen. Damit werden die Antwortzeiten kürzer, was die Performance
insgesamt verbessert.
</para>
</section>

<section id="database-configuration">
<title>Einrichten der Datenbank</title>

<section id="installation-of-database-with-the-web-installer">
<title>Der einfache Weg - Einrichtung der Datenbank mit Hilfe des Webinstallers
(nur für <application>MySQL</application>)</title>

<para>
Wenn Sie <application>MySQL</application> als Datenbank-Backend verwenden,
können Sie den Web-Installer von OTRS verwenden: <ulink
url="http://localhost/otrs/installer.pl">
<citetitle>http://localhost/otrs/installer.pl</citetitle> </ulink> .</para>

<para>
Der Webinstaller wird gestartet. Folgen Sie den Anweisungen auf dem
Bildschirm.
</para>

<para>
1. Lesen Sie die Informationen über die OTRS-Niederlassungen und klicken Sie
auf "Weiter".
</para>

<para>
<screenshot>
<screeninfo>installer.pl - Willkommensbildschirm</screeninfo> <graphic srccredit="installer.pl -
screenshot" scale="40" fileref="screenshots/installer1.png"></graphic></screenshot>
</para>

<para>
<emphasis>Abb. 3.1. Willkommensbildschirm.</emphasis>
</para>

<para>
2. Lesen Sie die GNU Affero General Public License und akzeptieren Sie sie
durch Klick auf "Akzeptieren".
</para>

<para>
<screenshot>
<screeninfo>installer. pl - Lizenz (1/4)</screeninfo> <graphic srccredit="installer.pl -
screenshot" scale="40" fileref="screenshots/installer2.png"></graphic></screenshot>
</para>

<para>
<emphasis>Abb. 3.2. GNU Affero General Public License.</emphasis>
</para>

<para>
3. Geben Sie Benutzernamen und Passwort für den Administrator an, den
DNS-Namen des Servers, auf dem OTRS läuft, und den zu verwendenden
Datenbanktyp. Prüfen Sie danach die Einstellungen.
</para>

<para>
<screenshot>
<screeninfo>installer.pl - Datenbank-Grundeinstellungen (2/4)</screeninfo> <graphic srccredit="installer.pl -
screenshot" scale="40" fileref="screenshots/installer3.png"></graphic></screenshot>
</para>

<para>
<emphasis>Abb. 3.3. Datenbank-Grundeinstellungen.</emphasis>
</para>

<para>
Wenn die Prüfung erfolgreich war, erhalten Sie einen Hinweis. Drücken Sie
"Ok" zum Fortfahren.
</para>

<para>
<screenshot>
<screeninfo>installer.pl - Prüfung der Datenbankeinstellungen (2/4)</screeninfo> <graphic srccredit="installer.pl -
screenshot" scale="40" fileref="screenshots/installer4.png"></graphic></screenshot>
</para>

<para>
<emphasis>Abb. 3.4. Hinweis auf erfolgreiche Prüfung.</emphasis>
</para>

<para>
4. Erstellen Sie einen neuen Datenbankbenutzer, wählen Sie einen Namen für
die Datenbank und klicken Sie auf "Weiter".
</para>

<warning>
<para>
Man sollte nie Standard-Passwörter verwenden. Bitte ändern Sie das
Standardpasswort der OTRS-Datenbank!
</para>
</warning>

<para>
<screenshot>
<screeninfo>installer.pl - Datenbankeinstellungen (2/4)</screeninfo> <graphic srccredit="installer.pl -
screenshot" scale="40" fileref="screenshots/installer5.png"></graphic></screenshot>
</para>

<para>
<emphasis>Abb. 3.5. Datenbankeinstellungen.</emphasis>
</para>

<para>
Wenn der Datenbankbenutzer und die Datenbank erfolgreich angelegt wurden,
erhalten Sie eine Bestätigung. Klicken Sie auf 'Weiter', um fortzufahren.
</para>

<para>
<screenshot>
<screeninfo>installer.pl - Erstellung der Datenbank erfolgreich</screeninfo> <graphic srccredit="installer.pl -
screenshot" scale="40" fileref="screenshots/installer6.png"></graphic></screenshot>
</para>

<para>
<emphasis>Abb. 3.6. Bestätigung der erfolgreichen
Datenbankeinrichtung.</emphasis>
</para>

<para>
5. Geben Sie alle benötigten Systemeinstellungen an und klicken Sie
"Weiter".
</para>

<para>
<screenshot>
<screeninfo>installer.pl - Systemeinstellungen (3/4)</screeninfo> <graphic srccredit="installer.pl -
screenshot" scale="40" fileref="screenshots/installer7.png"></graphic></screenshot>
</para>

<para>
<emphasis>Abb. 3.7. Systemeinstellungen.</emphasis>
</para>

<para>
6. Wenn Sie wollen, können Sie an dieser Stelle eingehende und ausgehende
E-Mail-Verbindungen einrichten, oder diesen Schritt überspringen.
</para>

<para>
<screenshot>
<screeninfo>installer.pl - E-Mail-Konfiguration (3/4)</screeninfo> <graphic srccredit="installer.pl -
screenshot" scale="40" fileref="screenshots/installer8.png"></graphic></screenshot>
</para>

<para>
<emphasis>Abb. 3.8. E-Mail-Konfiguration.</emphasis>
</para>

<para>
7. Starten Sie den OTRS-Dienst neu, damit die neuen
Konfigurationseinstellungen verwendet werden.
</para>

<para>
<screen>
linux:~ # rcotrs restart-force
Shutting down OTRS
 Disable /opt/otrs/bin/otrs.PostMaster.pl ... done.
no crontab for otrs
 Shutting down cronjobs ... failed!
Shutting down OTRS (completely)
 Shutting down Apache ... done.
 Shutting down MySQL ... done.
                                                                     done
Starting OTRS (completely)
 Starting Apache ... done.
 Starting MySQL ... done.
Starting OTRS
 Checking Apache ... done.
 Checking MySQL ... done.
 Checking database connect... (It looks Ok!).
 Enable /opt/otrs/bin/otrs.PostMaster.pl ... done.
 Checking otrs spool dir...  done.
 Creating cronjobs (source /opt/otrs/var/cron/*) ... done.

  -->> http://linux.example.com/otrs/index.pl &lt;&lt;--
                                                                     done
                                                                     done
linux:~ #
</screen>
</para>

<para>
<emphasis>Skript 3.13. Neustart des OTRS-Dienstes.</emphasis>
</para>

<para>
Herzlichen Glückwunsch! Die Installation ist abgeschlossen, jetzt können Sie
mit dem System arbeiten. Um sich anzumelden, verwenden Sie bitte die Adresse
<ulink url="http://localhost/otrs/index.pl">
<citetitle>http://localhost/otrs/index.pl</citetitle> </ulink> in ihrem
Webbrowser. Melden Sie sich als Administrator and, mit dem Benutzernamen
'root@localhost' und dem Passwort 'root'. Anschließend können Sie das System
gemäß Ihrer Anforderungen konfigurieren.
</para>

<warning>
<para>
Bitte ändern Sie das Passwort für den Benutzer 'root@localhost' umgehend.
</para>
</warning>

<para>
<screenshot>
<screeninfo>installer.pl - Abgeschlossen (4/4)</screeninfo> <graphic srccredit="installer.pl -
screenshot" scale="40" fileref="screenshots/installer9.png"></graphic></screenshot>
</para>

<para>
<emphasis>Abb. 3.9. Letzte Schritte zur Installation von OTRS.</emphasis>
</para>

</section>

<section id="manual-installation-of-database">
<title>Manuelle Installation der OTRS Datenbank</title>

<para>
Wenn Sie den Webinstaller nicht einsetzen können, kann die Datenbank für
OTRS auch manuell eingerichtet werden. Skripte mit dem Datenbankschema und
den SQL-Statements finden Sie im Verzeichnis
<filename>scripts/database</filename> innerhalb des Homeverzeichnisses des
Benutzers 'otrs'.
</para>

<para>
<screen>
linux:~# cd /opt/otrs/scripts/database/
linux:/opt/otrs/scripts/database# ls
otrs-initial_insert.db2.sql         otrs-schema.mysql.sql
otrs-schema.oracle.sql
otrs-initial_insert.mssql.sql       otrs-schema-post.db2.sql
otrs-initial_insert.mysql.sql       otrs-schema.postgresql.sql
otrs-initial_insert.oracle.sql
otrs-initial_insert.postgresql.sql  otrs-schema-post.mssql.sql
otrs-initial_insert.xml             otrs-schema-post.mysql.sql
otrs-schema.db2.sql                 otrs-schema-post.oracle.sql
 otrs-schema-post.postgresql.sql
otrs-schema.mssql.sql               otrs-schema.xml
linux:/opt/otrs/scripts/database#
</screen>
</para>

<para>
<emphasis>Skript 3.14. Für die Datenbankerstellung benötigte
Dateien.</emphasis>
</para>

<para>
Für die verschiedenen Datenbanktypen sind mehrere .sql-Dateien vorhanden,
die nacheinander abgearbeitet werden müssen.
</para>

<para>
<orderedlist numeration="arabic">
<title>Die OTRS-Datenbank manuell Schritt für Schritt anlegen</title>
<listitem>
<para>
Anlegen der Datenbank für OTRS: Legen Sie mit Hilfe Ihres
Datenbankinterfaces bzw. Ihrer Datenbankoberfläche die Datenbank an, die
später von OTRS verwendet werden soll.
</para>
</listitem>
<listitem>
<para>
Erstellen der Tabellen: Mit Hilfe der otrs-schema.Datenbanktyp.sql-Dateien
(z. B. <filename>otrs-schema.oracle.sql</filename>,
<filename>otrs-schema.postgresql.sql</filename>, usw.) können Sie die
Tabellen innerhalb der OTRS Datenbank erzeugen.
</para>
</listitem>
<listitem>
<para>
Einfügen der vom System benötigten Daten: Damit OTRS richtig funktioniert,
müssen einige Daten in verschiedene Tabellen geschrieben werden (z. B. die
verschiedenen Ticketstatus, Ticket- und Benachrichtigungstypen,
etc.). Verwenden Sie entweder die
Datei<filename>otrs-initial_insert.mysql.sql</filename>,
<filename>otrs-initial_insert.db2.sql</filename>,
<filename>otrs-initial_insert.oracle.sql</filename>,
<filename>otrs-initial_insert.postgresql.sql</filename> oder
<filename>otrs-initial_insert.mssql.sql </filename> zum Einspielen der
Daten, je nachdem welche Datenbank verwendet wird.
</para>
</listitem>
<listitem>
<para>
Erzeugen von "foreign keys" auf andere Tabellen: Abschließend müssen noch
die "foreign keys" erstellt werden, über die die verschiedenen Tabellen in
der OTRS Datenbank voneinander abhängen. Dies kann mit Hilfe der
otrs-schema-post.Datenbanktyp.sql-Dateien erreicht werden
(z. B. <filename>otrs-schema-oracle.post.sql</filename>,
<filename>otrs-schema-post.postgresql.sql</filename>, usw.).
</para>
</listitem>
</orderedlist>
</para>

<para>
Nachdem Sie die Datenbank angelegt haben, sollten Sie die Zugriffsrechte
dafür setzen und z. B. sicherstellen, dass nur ein bestimmter Benutzer ohne
Datenbank-Administrationsrechte Zugriff auf die OTRS Datenbank hat. Je
nachdem, welche Datenbank Sie einsetzen, unterscheiden sich hier die
Vorgehensweisen, es sollte jedoch möglich sein dies mit Hilfe Ihres
Datenbankinterfaces bzw. Ihrer Datenbankoberfläche zu erledigen.
</para>

<para>
Wurden die nötigen Einstellungen für die Datenbank vorgenommen, muss nun
noch dem Ticket-System mitgeteilt werden, welche Datenbank es verwenden
soll. Öffnen Sie die Datei <filename>Kernel/Config.pm</filename> innerhalb
des Homeverzeichnisses des OTRS Benutzers und passen Sie die dafür
vorgesehenen Parameter an.
</para>

<para>
<programlisting>

    # DatabaseHost
    # (The database host.)
    $Self->{'DatabaseHost'} = 'localhost';

    # Database
    # (The database name.)
    $Self->{Database} = 'otrs';

    # DatabaseUser
    # (The database user.)
    $Self->{DatabaseUser} = 'otrs';

    # DatabasePw
    # (The password of database user.)
    $Self->{DatabasePw} = 'some-pass';

</programlisting>
</para>

<para>
<emphasis>Skript 3.15. Anzupassende Einstellungen.</emphasis>
</para>

</section>

</section>

<section id="cronjobs">
<title>Einrichten der von OTRS benötigten cron-Jobs</title>

<para>
Damit OTRS voll funktioniert, werden einige cron-Jobs benötigt. Die
cron-Jobs sollten mit denselben Benutzerrechten ausgeführt werden, die auch
für die restlichen OTRS-Skripte vergeben wurden, d.h. die cron-Jobs sollten
in die crontab des Benutzers 'otrs' eingetragen werden.
</para>

<para>
Alle Skripte für die verschiedenen cron-Jobs befinden sich im Verzeichnis
<filename>var/cron</filename> innerhalb des Homeverzeichnisses des Benutzers
'otrs'.
</para>

<para>
<screen>
linux:~# cd /opt/otrs/var/cron
linux:/opt/otrs/var/cron# ls
aaa_base.dist                generic_agent.dist       rebuild_ticket_index.dist
cache.dist                   pending_jobs.dist        session.dist
fetchmail.dist               postmaster.dist          unlock.dist
generic_agent-database.dist  postmaster_mailbox.dist
linux:/opt/otrs/var/cron#
</screen>
</para>

<para>
<emphasis>Skript 3.16. Für die Erstellung der Cronjobs benötigte
Dateien.</emphasis>
</para>

<para>
Alle Skripte tragen die Endung .dist und sollten zunächst so umkopiert
werden, dass keine Endung mehr vorhanden ist.
</para>

<para>
<screen>
linux:/opt/otrs/var/cron# for foo in *.dist; do cp $foo `basename $foo .dist`; done
linux:/opt/otrs/var/cron# ls
aaa_base                generic_agent-database.dist  rebuild_ticket_index
aaa_base.dist           generic_agent.dist           rebuild_ticket_index.dist
cache                   pending_jobs                 session
cache.dist              pending_jobs.dist            session.dist
fetchmail               postmaster                   unlock
fetchmail.dist          postmaster.dist              unlock.dist
generic_agent           postmaster_mailbox
generic_agent-database  postmaster_mailbox.dist
linux:/opt/otrs/var/cron#
</screen>
</para>

<para>
<emphasis> Skript 3.17. Kopieren und Umbenennen der für die Erstellung der
Cronjobs benötigten Dateien. </emphasis>
</para>

<para>
Die folgende Tabelle gibt eine kurze Übersicht über die Aufgabe der
verschiedenen Skripte.
</para>

<para>
<table id="table-of-cronjobs-for-otrs">
<title>Die verschiedenen Skripte für die cron-Jobs von OTRS.</title>
  <tgroup cols="2">
    <thead>
      <row>
        <entry>
          Skript
        </entry>
        <entry>
          Funktion
        </entry>
      </row>
    </thead>
    <tbody>
      <row>
        <entry>
          aaa_base
        </entry>
        <entry>
          Über dieses Skript werden die grundlegenden Einstellungen für die crontab
des Benutzers 'otrs' festgelegt.
        </entry>
      </row>
      <row>
        <entry>
          cache
        </entry>
        <entry>
          Löscht abgelaufene Cache-Einträge von der Festplatte. Leert den Cache von
CSS- und JavaScript-Dateien.
        </entry>
      </row>
      <row>
        <entry>
          fetchmail
        </entry>
        <entry>
          Falls Nachrichten mit Hilfe von fetchmail in das System eingespeist werden
sollen, kann dieses Skript verwendet werden.
        </entry>
      </row>
      <row>
        <entry>
          generic_agent
        </entry>
        <entry>
          Mit Hilfe dieses Skripts werden die Jobs des GenericAgents ausgeführt, die
über eigene Konfigurationsdateien festgelegt wurden.
        </entry>
      </row>
      <row>
        <entry>
          generic_agent-database
        </entry>
        <entry>
          Mit Hilfe dieses Skripts werden die Jobs des GenericAgents ausgeführt, die
über dem Administrations-Bereich innerhalb von "GenericAgent" angelegt
wurden.
        </entry>
      </row>
      <row>
        <entry>
          pending_jobs
        </entry>
        <entry>
          Mit Hilfe dieses Skripts wird das System auf "wartende" (pending) Tickets
überprüft.
        </entry>
      </row>
      <row>
        <entry>
          postmaster
        </entry>
        <entry>
          Mit Hilfe dieses Skripts wird die Nachrichten-Warteschlange von OTRS
überprüft und noch nicht verarbeitete Nachrichten werden im System
gespeichert bzw. zugestellt.
        </entry>
      </row>
      <row>
        <entry>
          postmaster_mailbox
        </entry>
        <entry>
          Mit Hilfe dieses Skripts werden die verschiedenen pop3-Konten abgefragt, die
im Administrations-Bereich innerhalb von "PostMaster POP3 Account"
eingerichtet wurden.
        </entry>
      </row>
      <row>
        <entry>
          rebuild_ticket_index
        </entry>
        <entry>
          Mit Hilfe dieses Skripts wird der Ticket-Index für die Queue-Ansicht neu
erzeugt, wodurch die Anzeige beschleunigt wird.
        </entry>
      </row>
      <row>
        <entry>
          session
        </entry>
        <entry>
          Über dieses Skript werden alte und nicht mehr gültige Session-IDs entfernt.
        </entry>
      </row>
      <row>
        <entry>
          unlock
        </entry>
        <entry>
          Mit Hilfe dieses Skripts wird die Freigabe von Tickets innerhalb des Systems
ermöglicht.
        </entry>
      </row>
    </tbody>
  </tgroup>
</table>
</para>

<para>
Für die Einrichtung aller cron-Jobs kann das Skript
<filename>bin/Cron.sh</filename> verwendet werden, das sich im
Homeverzeichnis des OTRS-Benutzers befindet. Dem Skript muss beim Aufruf ein
Parameter übergeben werden. Dieser Parameter legt fest, ob die cron-Jobs
installiert, deinstalliert oder neu gestartet werden. Es sind folgende
Parameter zulässig:
</para>

<para>
<cmdsynopsis>
  <command>Cron.sh</command>    <arg choice='req'>
<replaceable>start</replaceable>    </arg>    <arg choice='req'>
<replaceable>stop</replaceable>    </arg>    <arg choice='req'>
<replaceable>restart</replaceable>    </arg>    <arg choice='opt'>
<replaceable>OTRS-Benutzer</replaceable>    </arg></cmdsynopsis>
</para>

<para>
Da die cron-Jobs für den Benutzer 'otrs' angelegt werden sollen, muss das
Skript von diesem Benutzer ausgeführt werden. Sind Sie z. B. als Benutzer
root am System angemeldet, können Sie mit Hilfe des Kommandos <command>su
otrs</command> zum OTRS-Benutzer wechseln. Nehmen Sie also die Installation
wie folgt vor.
</para>

<warning>
<para>
Bitte beachten Sie, dass durch die Verwendung von
<filename>Cron.sh</filename> evtl. andere Cron-Jobs des OTRS-Benutzers
überschrieben bzw. gelöscht werden. Um weitere, nicht von OTRS benötigte
Cron-Jobs für den OTRS-Benutzer zu installieren, erweitern Sie bitte
<filename>Cron.sh</filename> dementsprechend.
</para>
</warning>

<para>
<screen>
linux:/opt/otrs/var/cron# cd /opt/otrs/bin/
linux:/opt/otrs/bin# su otrs
linux:~/bin$ ./Cron.sh start
/opt/otrs/bin
Cron.sh - start/stop OTRS cronjobs
Copyright (C) 2001-2009 OTRS AG, http://otrs.org/
(using /opt/otrs) done
linux:~/bin$ exit
exit
linux:/opt/otrs/bin#
</screen>
</para>

<para>
<emphasis>Skript 3.18. Installation der Cronjobs.</emphasis>
</para>

<para>
Mit Hilfe des Kommandos <command>crontab -l -u otrs</command>, das Sie als
root ausführen können, wird die crontab-Datei des Benutzers 'otrs' angezeigt
und Sie können überprüfen, ob alle Einträge vorhanden sind.
</para>

<para>
<screen>
linux:/opt/otrs/bin# crontab -l -u otrs
# --
# cron/aaa_base - base crontab package
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# Who gets the cron emails?
MAILTO="root@localhost"

# --
# cron/cache - delete expired cache
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# delete expired cache weekly (Sunday mornings)
20 0 * * 0  $HOME/bin/otrs.CacheDelete.pl --expired >> /dev/null
30 0 * * 0  $HOME/bin/otrs.LoaderCache.pl -o delete >> /dev/null

# --
# cron/fetchmail - fetchmail cron of the OTRS
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# fetch every 5 minutes emails via fetchmail
#*/5 * * * * /usr/bin/fetchmail -a &gt;&gt; /dev/null

# --
# cron/generic_agent - otrs.GenericAgent.pl cron of the OTRS
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# start generic agent every 20 minutes
*/20 * * * * $HOME/bin/GenericAgent.pl &gt;&gt; /dev/null
# example to execute GenericAgent.pl on 23:00 with
# Kernel::Config::GenericAgentMove job file
#0 23 * * * $HOME/bin/otrs.GenericAgent.pl -c "Kernel::Config::GenericAgentMove" &gt;&gt; /dev/null
# --
# cron/generic_agent - GenericAgent.pl cron of the OTRS
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# start generic agent every 10 minutes
*/10 * * * * $HOME/bin/otrs.GenericAgent.pl -c db &gt;&gt; /dev/null
# --
# cron/pending_jobs - pending_jobs cron of the OTRS
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# check every 120 min the pending jobs
45 */2 * * * $HOME/bin/otrs.PendingJobs.pl &gt;&gt; /dev/null
# --
# cron/postmaster - postmaster cron of the OTRS
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# check daily the spool directory of OTRS
#10 0 * * * * test -e /etc/init.d/otrs &amp; /etc/init.d/otrs cleanup &gt;&gt; /dev/null; test -e /etc/rc.d/init.d/otrs &amp;&amp; /etc/rc.d/init.d/otrs cleanup &gt;&gt; /dev/null
10 0 * * * $HOME/bin/otrs.CleanUp.pl &gt;&gt; /dev/null
# --
# cron/postmaster_mailbox - postmaster_mailbox cron of the OTRS
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# fetch emails every 10 minutes
*/10 * * * * $HOME/bin/otrs.PostMasterMailbox.pl &gt;&gt; /dev/null
# --
# cron/rebuild_ticket_index - rebuild ticket index for OTRS
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# just every day
01 01 * * * $HOME/bin/otrs.RebuildTicketIndex.pl &gt;&gt; /dev/null

# --
# cron/session - delete old session ids of the OTRS
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# delete every 120 minutes old/idle session ids
55 */2 * * * $HOME/bin/otrs.DeleteSessionIDs.pl --expired &gt;&gt; /dev/null

# --
# cron/unlock - unlock old locked ticket of the OTRS
# Copyright (C) 2001-2014 OTRS AG, http://otrs.com/
# --
# This software comes with ABSOLUTELY NO WARRANTY.
# --
# unlock every hour old locked tickets
35 * * * * $HOME/bin/otrs.UnlockTickets.pl --timeout &gt;&gt; /dev/null

linux:/opt/otrs/bin#
</screen>
</para>

<para>
<emphasis>Skript 3.19. Crontab-Datei.</emphasis>
</para>

</section>

</section>

<section id="upgrading">
<title>Upgrade des OTRS Frameworks</title>
<para>
Diese Hinweise sind für Leute gedacht, die von OTRS 2.4 auf 3.0 upgraden,
und gilt für RPM-basierte und manuelle Upgrades (tarball).
</para>
<para>
Wenn Sie eine ältere Version von OTRS einsetzen, müssen sie zuerst dem
Upgrade-Pfad zur 2.4 folgen
(1.1-&gt;1.2-&gt;1.3-&gt;2.0-&gt;2.1-&gt;2.2-&gt;2.3-&gt;2.4->&gt;3.0 ...).
</para>
<para>Wenn Sie ein "Patchlevel-Update" durchführen wollen, z. B. von OTRS 3.0.3
auf 3.0.4, dann sollten Sie die Schritte 8, 9, 10 und 13 - 16 auslassen.
</para>

  <orderedlist>
      <listitem>
        <para>
            Stoppen Sie alle relevanten Dienste.
        </para>
        <para>
            z. B. (hängt von eingesetzten Diensten ab): <screen>
shell&gt; /etc/init.d/cron stop
shell&gt; /etc/init.d/postfix stop
shell&gt; /etc/init.d/apache stop
            </screen>
        </para>
      </listitem>
      <listitem>
        <para>
            Sichern Sie folgende Daten in $OTRS_HOME (Standard: OTRS_HOME=/opt/otrs):
            <itemizedlist>
                <listitem><para><filename>Kernel/Config.pm</filename></para></listitem>
                <listitem><para><filename>Kernel/Config/GenericAgent.pm</filename></para></listitem>
                <listitem><para><filename>Kernel/Config/Files/ZZZAuto.pm</filename></para></listitem>
                <listitem><para><filename>var/*</filename></para></listitem>
            </itemizedlist>
        </para>
      </listitem>
      <listitem>
        <para>
            Sichern Sie die Datenbank.
        </para>
      </listitem>
      <listitem>
        <para>
            Neues System aufsetzen (optional). Wenn möglich, installieren Sie zunächst
auf einer separaten Testmaschine.
        </para>
      </listitem>
      <listitem>
        <para>
            Installieren Sie das neue Release (tar oder RPM).
        </para>
         <itemizedlist>
          <listitem>
            <para>
                Mit dem Tarball:
            </para>
            <para>
                <screen>
shell&gt; cd /opt
shell&gt; tar -xzf otrs-x.x.x.tar.gz
shell&gt; ln -s otrs-x.x.x otrs
                </screen>
            </para>
            <para>
                Alte Configdateien wiederherstellen.
                <itemizedlist>
                    <listitem><para><filename>Kernel/Config.pm</filename></para></listitem>
                    <listitem><para><filename>Kernel/Config/GenericAgent.pm</filename></para></listitem>
                    <listitem><para><filename>Kernel/Config/Files/ZZZAuto.pm</filename></para></listitem>
                </itemizedlist>
            </para>
          </listitem>
          <listitem>
            <para>
                Per RPM: <screen>
shell&gt; rpm -Uvh otrs-x.x.x.-01.rpm
                </screen>
            </para>
            <para>
                In diesem Fall stellt das RPM-Update die alten Konfigurationsdateien
automatisch wieder her.
            </para>
          </listitem>
         </itemizedlist>
      </listitem>
      <listitem>
        <para>
            Eigene Themes
        </para>
        <para>
            Hinweis: Die OTRS-Themes von 2.4 sind nicht zu 3.0 kompatibel, verwenden Sie
ihre alten Themes daher nicht weiter! (Themes befinden sich in
/opt/otrs/Kernel/Output/HTML/*/*.dtl)
        </para>
      </listitem>
      <listitem>
        <para>
            Setzen Sie die Datei-Berechtigungen.
        </para>
        <para>
            wenn der Tarball benutzt wird, führen Sie <screen>
shell> cd /opt/otrs/
shell> bin/otrs.SetPermissions.pl
            </screen> aus, um die Berechtigungen zu setzen, die für Ihr System benötigt
werden.
        </para>
      </listitem>
      <listitem>
        <para>
            Wenden Sie die Datenbankänderungen an (Teil 1/2):
        </para>
        <para>
            <screen>
shell&gt; cd /opt/otrs/

# MySQL:
shell&gt; cat scripts/DBUpdate-to-3.0.mysql.sql | mysql -p -f -u root otrs
# PostgreSQL:
shell&gt; cat scripts/DBUpdate-to-3.0.postgresql.sql | psql otrs
            </screen>
        </para>
      </listitem>
      <listitem>
        <para>
            Führen Sie das Migrationsskript aus (als OTRS-Benutzer, nicht als root!):
        </para>
        <para>
            Sie müssen das Migrationsskript ausführen, um die Daten auf die neue
Datenbankstruktur zu übernehmen. Bitte führen Sie <screen>
shell&gt; scripts/DBUpdate-to-3.0.pl
            </screen> aus.
        </para>
      </listitem>
      <listitem>
        <para>
            Datenbankänderungen anwenden (Teil 2/2):
        </para>
        <para>
            <screen>
# MySQL:
shell&gt; cat scripts/DBUpdate-to-3.0-post.mysql.sql | mysql -p -f -u root otrs
# PostgreSQL:
shell&gt; cat scripts/DBUpdate-to-3.0-post.postgresql.sql | psql otrs
            </screen>
        </para>
      </listitem>
      <listitem>
        <para>
Systemkonfiguration aktualisieren und Caches löschen. Bitte führen Sie aus:
        </para>
        <para>
            <screen>
shell&gt; bin/otrs.RebuildConfig.pl
shell&gt; bin/otrs.DeleteCache.pl
            </screen>
        </para>
      </listitem>
      <listitem>
        <para>
            Starten Sie Ihre Dienste neu.
        </para>
        <para>
            z. B. (hängt von eingesetzten Diensten ab): <screen>
shell&gt; /etc/init.d/cron stop
shell&gt; /etc/init.d/postfix stop
shell&gt; /etc/init.d/apache stop
</screen>
        </para>
      </listitem>
      <listitem>
        <para>Check installed packages</para>
        <para>
            In the package manager, check if all packages are still marked as correctly
installed or if any require reinstallation or even a package upgrade.
        </para>
      </listitem>
      <listitem>
        <para>
    Prüfen Sie auf mögliche Kodierungsprobleme:
        </para>
        <para>
            Mit OTRS 3.0 wurde der Standardzeichensatz von "ISO-8859-1" auf "utf-8"
umgestellt.
        </para>
        <para>
            Von dieser Änderung sind Sie nur betroffen, wenn sie in Kernel/Config.pm
keinen Zeichensatz eingestellt haben (alle Installationen, die unter
Verwendung des Web-Installers angelegt wurden, haben dort einen
konfigurierten Wert), und sie den vorkonfigurierten Wert nicht in
AdminSysconfig geändert haben.
        </para>
        <para>
            Wenn Sie mit dem neuen Zeichensatz Probleme feststellen sollten, dann fügen
Sie diese Zeile zu Kernel/Config.pm hinzu: <screen>
    $Self->{'DefaultCharset'} = 'iso-8859-1';
            </screen>
        </para>
        <para>
            Generell ist "utf-8" der empfohlene Zeichensatz für den Betrieb von OTRS,
und die Umstellung von "iso-8859-1" sollte problemlos verlaufen.
        </para>
        <para>
            Hinweis: Wir empfehlen, alle existierenden nicht-UTF-8-Installationen
bereits jetzt mit dem Update auf 3.0 auf UTF-8 umzustellen. Andere
Zeichensätze sind ab sofort im Status "veraltet / nicht empfohlen".
        </para>
        <para>
            OTRS 3.1 wird nur noch UTF-8 als internen Zeichensatz unterstützen.
        </para>
      </listitem>
      <listitem>
        <para>Auf angepasste Frontend-Modulregistrierungen prüfen</para>
        <para>
            Seit OTRS 3.0 können Applikationsmodule ihr eigenes spezielles CSS und/oder
Javascript haben. Dieses wird als Teil der sog. Frontend-Modulregistrierung
der Module in der SysConfig angegeben. Das kann Probleme beim Upgrade
verursachen, weil lokal geänderte Frontend-Modulregistrierungen die Updates
der neuen Standardkonfiguration nicht erhalten.
        </para>
        <para>
            Ob Sie betroffen sind, können sie herausfinden, indem Sie sich
<filename>Kernel/Config/Files/ZZZAuto.pm</filename> ansehen und nach
Einträgen wie <screen>
    $Self->{'Frontend::Module'}->{'AgentStats'} = { ... };
            </screen> suchen
        </para>
        <para>
            Diese Einträge sollten auf ihren Standardwert zurückgesetzt werden, in Admin
-> SysConfig (in diesem Fall: 'Frontend::Module###AgentStats') mit dem
kleinen "Zurücksetzen"-Knopf neben dem Optionsfeld "Aktiv". Dann werden die
Einträge zurückgesetzt auf ihren Standardwert und tauchen demzufolge nicht
mehr in <filename>Kernel/Config/Files/ZZZAuto.pm</filename> auf. Nach dieser
Maßnahme können Sie die Einträge wieder anpassen, falls erforderlich.
        </para>
        <para>
            Dieselbe Prozedur muss für den Eintrag
"Frontend::ToolBarModule###1-Ticket::TicketSearchFulltext" durchgeführt
werden, weil dieses auch modulspezifisches CSS verwendet. Wenn diese
Einstellung auf Ihrem System nicht aktiv ist, können Sie diesen Schritt
überspringen.
        </para>
      </listitem>
      <listitem>
        <para>Auf angepasste PreferencesGroups-Einträge prüfen</para>
        <para>
            In OTRS 3.0 gab es einige Korrekturen in den
PreferencesGroups-Konfigurationseinträgen. Die Schlüssel 'Activ' und 'Colum'
wurden in 'Active' und 'Column' geändert. Sie müssen sich darum nur kümmern,
wenn Sie solche Einträge in Ihrem System angepasst haben, ansonsten werden
sie automatisch aktualisiert.
        </para>
        <para>
            Ob Sie betroffen sind, können sie herausfinden, indem Sie sich
<filename>Kernel/Config/Files/ZZZAuto.pm</filename> ansehen und nach
Einträgen wie <screen>
    $Self->{'CustomerPreferencesGroups'}->{'RefreshTime'} =  {
      'Activ' => '0',
      'Colum' => 'Frontend',
      'Data' => {
        '' => 'off',
        '10' => '10 minutes',
        '15' => '15 minutes',
        '2' => ' 2 minutes',
        '5' => ' 5 minutes',
        '7' => ' 7 minutes'
      },
      'Desc' => 'Select your QueueView refresh time.',
      'Label' => 'QueueView refresh time',
      'Module' => 'Kernel::Output::HTML::PreferencesGeneric',
      'PrefKey' => 'UserRefreshTime',
      'Prio' => '4000'
    };
            </screen> suchen. Diese müssen wie
folgt verändert werden: <screen>
    $Self->{'CustomerPreferencesGroups'}->{'RefreshTime'} =  {
      'Active' => '0',
      'Column' => 'Frontend',
      'Data' => {
        '' => 'off',
        '10' => '10 minutes',
        '15' => '15 minutes',
        '2' => ' 2 minutes',
        '5' => ' 5 minutes',
        '7' => ' 7 minutes'
      },
      'Desc' => 'Select your QueueView refresh time.',
      'Label' => 'QueueView refresh time',
      'Module' => 'Kernel::Output::HTML::PreferencesGeneric',
      'PrefKey' => 'UserRefreshTime',
      'Prio' => '4000'
    };
            </screen>
        </para>
      </listitem>
      <listitem>
        <para>
            Feld-Umbenennung im Kunden-Datenbankbackend
        </para>
        <para>
            Das Feld 'salutation' in der eingebauten Kundendatenbank wurde umbenannt in
das angemessenere 'title'. Falls Sie die eingebaute Datenbank als Backend
für Kundenverwaltung benutzen, und Sie die Konfiguration angepasst haben,
z. B. weil Sie Felder zu der Datenbank hinzugefügt haben, oder die
Unterstützung für Kunden-Unternehmen aktiviert haben, sollten Sie das
Mapping in Ihrer <filename>Kernel/Config.pm</filename> anpassen:
        </para>
        <para>
             Verändern Sie diese Zeile: <screen>
     [ 'UserSalutation', 'Salutation', 'salutation', 1, 0, 'var', '', 0 ],
            </screen>
folgendermaßen: <screen>
     [ 'UserTitle',      'Title',      'title',      1, 0, 'var', '', 0 ],
            </screen>
        </para>
        <para>
            Davon können auch Anreden oder andere Templates betroffen sein, in dem Sie
die Zeichenkette <literal>&lt;OTRS_*_UserSalutation&gt;</literal> verwendet
haben.  Wenn Sie diese Zeichenkette verwendet haben UND die interne
Kundendatenbank einsetzen, sollten Sie
<literal>&lt;OTRS_CURRENT_UserTitle&gt;</literal> stattdessen verwenden.
        </para>
      </listitem>
      <listitem>
        <para>
            Check Your Cronjobs
        </para>
        <para>
            With OTRS 3.0, some commandline scripts were renamed, such as
<filename>otrs.PostMaster.pl</filename>.  Please check that your cronjobs
still use the correct filenames. With RPM upgrades, files such as
<filename>/etc/sysconfig/otrs</filename> sometimes are not correctly
overwritten, thus keeping the old cron settings, which may lead to errors.
        </para>
      </listitem>
      <listitem>
        <para>
            Optional: Tickets als gelesen markieren
        </para>
        <para>
            In OTRS 3.0 gibt es eine neue Funktion: neue Tickets und neue Artikel, die
ein Agent noch nicht gelesen hat, werden als 'ungelesen' gekennzeichnet. Für
alle Tickets, die vor dem Upgrade auf OTRS 3.0 erstellt wurden, fehlt die
'gelesen'-Information jedoch, daher werden diese Tickets als 'ungelesen'
dargestellt. Wenn das Sie stört, können Sie ein Skript verwenden, welches
alle Tickets und alle Artikel im System für alle Agenten mit Leserechten auf
'gelesen' setzt. Beachten Sie, dass dieses Skript eine ganze Weile für seine
Arbeit benötigen kann! <screen>
shell> bin/otrs.MarkTicketAsSeen.pl
            </screen>
        </para>
      </listitem>
      <listitem>
        <para>Gut gemacht!</para>
      </listitem>
  </orderedlist>
</section>

<section id="upgrade-windows-installer">
<title>Upgrade mit dem Windows-Installer</title>
<para>
Derzeit gibt es keinen automatischen Upgrademechanismus für
OTRS-Installationen, die mit dem Windows-Installer erstellt wurden. Das
Upgrade besteht im Wesentlichen aus einem Backup der Datenbank und des
Filesystems, dem Deinstallieren von OTRS, der Installation der neuene
Version, der Wiederherstellung der Datenbank und dem Ausführen der
Upgrade-Prozedur.
</para>

<para>Das Upgrade wird beschrieben in <ulink
url="http://faq.otrs.org/otrs/public.pl?Action=PublicFAQ;ItemID=351">FAQ#
4200351</ulink>, und es gibt zudem ein informatives <ulink
url="http://www.youtube.com/watch?v=sf0R-reMTWc">YouTube-Video</ulink>
available.
</para>
</section>

</chapter>
