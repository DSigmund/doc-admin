<?xml version = '1.0' encoding = 'ISO-8859-1'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<!-- $Id: stats.xml,v 1.8 2010-09-07 16:48:07 en Exp $ -->
<chapter id="statistic-module">
<title>Stats module</title>

<para>
Stats and reports are essential for companies.
On the basis of stats, information can be evaluated and rated,
and eventually informed decisions can be made.
</para>

<para>
A stats module should meet a multitude of requirements:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
        Various OTRS modules are to be evaluated.
        </para>
    </listitem>
    <listitem>
        <para>
        Consideration of the user permission settings of the respective installation.
        </para>
    </listitem>
    <listitem>
        <para>
        Generation of complex statistics.
        </para>
    </listitem>
    <listitem>
        <para>
        Easy and fast configuration of stats.
        </para>
    </listitem>
    <listitem>
        <para>
        High performance.
        </para>
    </listitem>
    <listitem>
        <para>
        Support of a large number of output variants.
        </para>
    </listitem>
</itemizedlist>
</para>

<para>
The OTRS stats module tries to satisfy all these requirements. The core
feature is a GUI, which allows to configure stats with the click
of a mouse.
</para>

<para>
Statistical elements, i.e. files which supplement the functionalities of the
stats module for specific requirements, can be integrated to model complex
stats.
</para>

<para>
All requirements concerning the evaluation of personal data have been
considered. It is, for instance, not possible to directly evaluate
the activities of individual agents in the standard configuration.
</para>

<para>
The stats module enables OTRS users to make a quick
and easy evaluation of the activities on their system.
</para>

<section id="stats-usage" >
<title>Handling of the module by the agent</title>

<para>
As soon as the stats module has been installed and configured
successfully by the OTRS admin, the navigation
bar of every agent with read and/or write rights displays
the additional module link "Statistics", which has various action links,
as shown in the Figure 19.1.
</para>

<para>
<screenshot>
<screeninfo>The stats module</screeninfo>
<graphic fileref="screenshots/stats-menu.png" scale="40" srccredit="stats-menu - Screenshot" />
</screenshot>
</para>

<para>
    <emphasis>Figure 19.1. Action lists of the statistics.</emphasis>
</para>

<para>
The different options provided in the statistics menu are:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
            <emphasis>Overview</emphasis>.
            Automatically shown if the module link "Statistics" is chosen.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>New</emphasis>. Requires rw rights.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>Import</emphasis>. Requires rw rights.
        </para>
    </listitem>
</itemizedlist>
</para>

<section id="stats-overview" >
<title>Overview</title>

<para>
A list of all pre-configured stats the agent can use (see Figure 19.2 below).
</para>

<para>
The easiest way to access the overview is to select the "Statistics"
link and then the action link "Overview" in the navigation bar. The
stats overview is called up automatically when the module
link "Statistics" in the navigation bar is chosen.
</para>

<para>
<screenshot>
<screeninfo>Overview of the standard statistics</screeninfo>
<graphic fileref="screenshots/stats-overview.png" scale="40" srccredit="stats-overview - Screenshot" />
</screenshot>
</para>

<para>
    <emphasis>Figure 19.2. Overview of the standard statistics.</emphasis>
</para>

<para>
The following information is provided about the stats listed
in the overview:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
            <emphasis>Stat#</emphasis>. Unique statistic number.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>Title</emphasis>. Title of the statistic.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>Object</emphasis>. Object used for generating the statistic.
            In the case of a static statistic, no object is displayed as no dynamic
            object is used for its generation.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>Description</emphasis>. Excerpt of the statistic's description.
        </para>
    </listitem>
</itemizedlist>
</para>

<para>
Below the list of statistics, there is a results display, which provides
information about the number of accessible stats. If the
overview covers more than one page, the agent can browse
through the different pages.
</para>

<para>
The agents can sort the stats ascending or descending, according to their needs,
just by clicking the desired sorting key field of the headline.
</para>

<para>
To generate a statistic, the right one is chosen by clicking the
link with the stat number, which leads to the "View" user interface.
</para>

<para>
A few sample stats are imported when the stats module
is used for the first time.
</para>

</section>

<section id="stats-viewing-generating">
<title>Generate and view stats</title>

<para>
The view user interface is supposed to provide the agent with an
overview of the stat's pre-configuration (see Figure 19.3 below).
</para>

<para>
<screenshot id="stats-view-screenshot" >
<screeninfo>Stat view</screeninfo>
<graphic fileref="screenshots/stats-view.png" scale="40" srccredit="stats-view - Screenshot" />
</screenshot>
</para>

<para>
    <emphasis>Figure 19.3. Viewing a specific statistic.</emphasis>
</para>

<para>
The agents can perform configurations within the range of the
pre-configuration. The originator of a stat configuration can determine
the degree to which the stat generation can be influenced. The most extreme
examples of this would be agents who can't effect any changes or can
change all attributes, respectively.
</para>

<para>
The page shows the following:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
        Possible actions:
        </para>

        <para>
        <itemizedlist>
            <listitem>
                <para>
                    <emphasis>Go to overview</emphasis>.
                    Link back to the starting point.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Edit</emphasis>.
                    Edit the current stat (rw rights required).
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Delete</emphasis>.
                    Delete the current stat (rw rights required).
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Export config</emphasis>.
                    Export a stat configuration, via file download
                   (rw rights required).
                </para>

                <para>
                    Usage: export and import functions allow for the convenient
                    creation and testing of stats on test systems and subsequent
                    easy integration into the production system.
                </para>
            </listitem>
        </itemizedlist>
        </para>
    </listitem>
    <listitem>
        <para>
        The stat details:
        </para>
        <para>
        <itemizedlist>
            <listitem>
                <para>
                    <emphasis>Stat#</emphasis>.
                    The number of the statistic.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Title</emphasis>.
                    The title of the statistic.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Object</emphasis>.
                    Object used for generating the stat.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Description</emphasis>.
                    Provides more detailed information
                    about the intention of the stat.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Format</emphasis>.
                    Stat output format. Depending on the configuration, any of the
                    following output formats can be chosen:
                </para>
                <para>
                <itemizedlist>
                    <listitem>
                        <para>
                        CSV.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Print.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Graph-lines.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Graph-bars.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Graph-hbars.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Graph-points.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Graph-lines-points.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Graph-area.
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                        Graph-pie.
                        </para>
                    </listitem>
                </itemizedlist>
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Graphsize</emphasis>.
                    Size (in pixels) which the graphic / chart may have.
                    This option is only given when the stat pre-configuration
                    allows it for a chart. All generally usable graphic sizes
                    are configured by the OTRS admin in the SysConfig. The agent
                    can then pre-select all relevant formats, while configuring the stats.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Sum rows</emphasis>.
                    Indicates whether the stat is amended by a column,
                    whose cells state the sums of the respective rows.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Sum columns</emphasis>.
                    Indicates whether the stat is amended by a row,
                    whose cells state the sum of the respective columns.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Cache</emphasis>.
                    Indicates whether the generated stats are
                    cached in the file system.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Valid</emphasis>.
                    This is set to "invalid" if a pre-configured statistic
                    is still being created or must not be used temporarily for certain
                    reasons. Also the "Start" button in the bottom right of the
                    block is then no longer displayed. The stat can no longer
                    be generated.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Created</emphasis>.
                    Creation time of the stat.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Created by</emphasis>.
                    Agent who created the stat.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Changed</emphasis>.
                    Time of the last stat's modification.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>Changed by</emphasis>.
                    Agent who altered the stat.
                </para>
            </listitem>
            <listitem>
                <para>
                    <emphasis>X-axis</emphasis>.
                    Using this function, the agent can exchange the x
                    and y axes (only when activated by the OTRS
                    administrator).
                </para>
            </listitem>
            <listitem>
                <para>
                The general information is followed by information about the stat
                itself. There are two different stat views:
                </para>
                <para>
                <itemizedlist>
                    <listitem>
                        <para>
                            <emphasis>Static stat view</emphasis>.
                            Complex stats cannot be generated dynamically, that is the reason why
                            static stat generators can be integrated into the stat module (see Figure 19.4 below).
                            They were developed specifically for the particular evaluation.
                            The various job definitions result in different views.
                        </para>
                        <para>
                        <screenshot>
                        <screeninfo>Static stat view</screeninfo>
                        <graphic fileref="screenshots/stats-view-static.png" scale="40" srccredit="stats-view-static - Screenshot" />
                        </screenshot>
                        </para>
                        <para>
                            <emphasis>Figure 19.4. Viewing a static statistic.</emphasis>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <emphasis>Dinamic stat view</emphasis> (see Figure 19.3 above).
                            They can be displayed in two different ways:
                        </para>
                        <para>
                        <itemizedlist>
                            <listitem>
                                <para>
                                    <emphasis>Unchangeable settings</emphasis>.
                                    The originator of the stat has no permission
                                    for modifying this fields.
                                </para>
                            </listitem>
                            <listitem>
                                <para>
                                    <emphasis>Changeable settings</emphasis>.
                                    The pre-configuration of such stats can be changed by the
                                    agent.
                                </para>
                            </listitem>
                        </itemizedlist>
                        </para>
                    </listitem>
                </itemizedlist>
                </para>
            </listitem>
        </itemizedlist>
        </para>
    </listitem>
</itemizedlist>
</para>

<para>
Pressing the "Start" button (at the bottom of the screen) is the
last simple step to generate a stat. There are two possible reasons for
this button to not be displayed:
</para>

<para>
<orderedlist numeration="arabic" >
    <listitem>
        <para>
        The stat was set to invalid and thus, deactivated.
        </para>
    </listitem>
    <listitem>
        <para>
        The stat was not configured neatly and is, therefore, not yet
        executable. In this case, the necessary information can be found
        in the OTRS notification section (below the navigation bar).
        </para>
    </listitem>
</orderedlist>
</para>

<para>
If the settings on the view page are incorrect, this page is shown again
after the "Start" button was pushed, and information about which input
was incorrect is provided in the notification section.
</para>
</section>

<section id="stats-modify-new">
<title>Edit - New</title>

<para>
Agents, who have write rights, can edit an existing stat configuration by calling
up the edit user interface of the stat module. There are two possibilites for that:
</para>

<para>
<orderedlist numeration="arabic">
<listitem>
    <para>
    Via the "Edit" button in the stat view.
    </para>
</listitem>
<listitem>
    <para>
    Via the "New" link in the menu of the Statistics module in the navigation bar.
    </para>
</listitem>
</orderedlist>
</para>

<para>
The stats are edited with a wizard in four steps:
</para>

<para>
<orderedlist numeration="arabic">
<listitem>
    <para>
    General specifications.
    </para>
</listitem>
<listitem>
    <para>
    Definition of the element for the X-axis.
    </para>
</listitem>
<listitem>
    <para>
    Specification of the value series.
    </para>
</listitem>
<listitem>
    <para>
    Definition of the restrictions to characterize the stat.
    </para>
</listitem>
</orderedlist>
</para>

<para>
Points 2 to 4 are only needed for the generation of dynamic stats. For a
static stat, only the general information (point 1) is required.
</para>

<para>
Information about how to handle the page is provided below the
input forms, on all input user interfaces of the stats module.
</para>

<para>
If incorrect data is entered nevertheless, the previously processed user
interface is displayed again and amended by information about the
incorrect input.
This information can be found in the OTRS notification section. The next
input user interface is only displayed after the form has been filled out
correctly.
</para>

<para>
<orderedlist numeration="arabic" >
<listitem>
    <para>
        <emphasis>General specifications</emphasis>.
        It is the first page of the wizard (see Figure 19.5 below).
    </para>

    <para>
    <screenshot>
    <screeninfo>General specifications of the stat</screeninfo>
    <graphic fileref="screenshots/stats-edit-general.png" scale="40" srccredit="stats-edit-general - Screenshot" />
    </screenshot>
    </para>

    <para>
        <emphasis>Figure 19.5. Editing the general specifications of a stat.</emphasis>
    </para>


    <para>
        In the screen showed in the Figure 19.5 there is a great number of common specifications
        and settings can be edited:
    </para>

    <para>
    <itemizedlist>
        <listitem>
            <para>
                <emphasis>Title</emphasis>.
                Should reflect the stat's purpose in a concise manner.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Description</emphasis>.
                More detailed information about the job definition, type of
                configuration parameters, etc.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Dynamic object</emphasis>.
                If the OTRS installation provides various dynamic
                objects, one of them can be chosen.
                The objects meet the requirements of the particular
                modules.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Static file</emphasis>.
                Usually this selection is not shown, as only static files which
                are not yet assigned to any stats are displayed. If
                "Static file" is displayed, however, it is important to
                tick the option field and select a generation mode
                (dynamic with a dynamic object or static with a file).
                If a static file is selected, the input user interfaces 2-4
                are not shown as the static file contains all required configurations.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Permission settings</emphasis>.
                Facilitate a restriction of the groups (and
                therefore, agents) who can later view and generate the
                preconfigured stats. Thus the various stats can be allocated to the
                different departments and work groups who need them. It is possible
                to allocate one stat to various groups.
            </para>

            <para>
                Example 1: The "stats" group was selected. The stat is
                viewable for all users having at least ro rights for the "stats"
                group. As the base requirement for accessing the view mode of the stat
                module in the default configuration is to have ro rights in the
                "stats" group, all users with permission to create statistics can view
                it in this configuration.
            </para>

            <para>
                Example 2: A group named "sales" was selected. All users with ro
                rights for the "sales" group can see the stat in the view mode and generate
                it. However, the stat will not be shown to other users
                with permission to generate stats.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Format</emphasis>.
                Output format of the stat.
                Depending on the configuration, one or more of the following formats can be chosen:
            </para>

            <para>
            <itemizedlist>
                <listitem>
                    <para>
                        CSV.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        Print.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        graph-lines.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        graph-bars.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        graph-hbars.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        graph-points.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        graph-lines-points.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        graph-area.
                    </para>
                </listitem>
                <listitem>
                    <para>
                        graph-pie.
                    </para>
                </listitem>
            </itemizedlist>
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Graphsize</emphasis>.
                Select the size (in pixels) the charts should have. This selection is only
                necessary if a graphical output format has been chosen under "Format".
                All graphic sizes that can generally be used are defined by the OTRS admin
                in SysConfig. When configuring the stat, the agent can pre-select all
                relevant formats.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Sum rows</emphasis>.
                Indicates whether the stat is amended by a column, whose
                cells contain the sum of the respective row.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Sum columns</emphasis>.
                Indicates whether the stat is amended by a row, whose
                cells contain the sum of the respective column.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Cache</emphasis>.
                Specifies if the generated stats should be cached in the file system.
                This saves computing power and time if the stat is called up again, but
                it only should be used if the stat's content is no longer
                changing.
            </para>

            <para>
                Caching is automatically prevented if the stat contains no time designation
                values (new data is added continuously) or if a time designation value points
                to the future.
            </para>

            <para>
                If a cached stat is edited, all cached data is deleted.
            </para>
        </listitem>
        <listitem>
            <para>
                <emphasis>Valid</emphasis>.
                It is set "invalid" if a pre-configured stat is
                still being created or must not be used temporarily for certain
                reasons. Also the "Start" button in the bottom right of the
                block is no longer displayed. It is impossible to generate the
                stat.
            </para>
        </listitem>
    </itemizedlist>
    </para>
</listitem>
<listitem>
    <para>
        <emphasis>Definition of the element for the X-axis</emphasis>.
        It is the configuration of the element used for the depiction of the X-axis or,
        if tables are used, of the column name chosen for the stat (see Figure 19.6).
    </para>

    <para>
    <screenshot>
    <screeninfo>Definition of the element for the X-axis.</screeninfo>
    <graphic fileref="screenshots/stats-edit-xaxis.png" scale="40" srccredit="stats-edit-xaxis - Screenshot" />
    </screenshot>
    </para>

    <para>
        <emphasis>Figure 19.6. Definition of the element for the X-axis.</emphasis>
    </para>

    <para>
    First of all, an element is selected using the option field. Then two or more
    attributes of the element must be selected. If no attributes are selected, all
    attributes are used including those added after the configuration of the stat.
    </para>

    <para>
    If the "Fixed" setting is disabled, the agent generating the stat can change the
    attributes of the respective element in the "View" user interface.
    </para>

    <para>
    Time elements are different as time period and scale have to be stated.
    Type and number of elements result from the used dynamic object
    and vary depending on it.
    </para>

    <para>
    If all input is correct, the "Next" button leads to the "Value series"
    form. It is also possible to go back to editing the "common statements"
    section again.
    </para>
</listitem>
<listitem>
    <para>
        <emphasis>Specification of the value series</emphasis>.
    </para>

    <para>
    In the third step of the stat pre-configuration the value series are
    defined (see Figure 19.7 below). They will lateron form the individual graphs of a diagramm
    or the various series (tabular view).
    </para>

    <para>
    <screenshot>
    <screeninfo>Definition of the value series</screeninfo>
    <graphic fileref="screenshots/stats-edit-valueseries.png" scale="40" srccredit="stats-edit-valueseries - Screenshot" />
    </screenshot>
    </para>

    <para>
        <emphasis>Figure 19.7. Definition of the value series.</emphasis>
    </para>

    <para>
    If an element is selected, each chosen attribute will correspond to a
    value series (see the Example 19-1 below).
    </para>

    <para>
    <example id="stats-value-series-1">
    <title>Definition of a value series - one element</title>

    <para>
    Element Queue:
    </para>

    <para>
    <itemizedlist>
        <listitem>
            <para>
            Value series 1 = Raw
            </para>
        </listitem>
        <listitem>
            <para>
            Value series 2 = Junk
            </para>
        </listitem>
        <listitem>
            <para>
            ....
            </para>
        </listitem>
    </itemizedlist>
    </para>
    </example>
    </para>

    <para>
    If two elements are selected, each selected attribute of the first element
    is combined with an attribute of the second element to form a value series
    (see the Example 19-2 below).
    </para>

    <para>
    <example id="stats-value-series-2" >
    <title>Definition of a value series - two elements </title>

    <para>
    Element 1 queue and element 2 status:
    </para>

    <para>
    <itemizedlist>
        <listitem>
            <para>
            Value chain 1 = Raw - open
            </para>
        </listitem>
        <listitem>
            <para>
            Value series 2 = Raw - successfully closed
            </para>
        </listitem>
        <listitem>
            <para>
            Value series 3 = Junk - open
            </para>
        </listitem>
        <listitem>
            <para>
            Value series 4 = Junk - successfully closed
            </para>
        </listitem>
    </itemizedlist>
    </para>
    </example>
    </para>

    <para>
    Selection of three or more elements does not make sense and is, therefore,
    prevented by an error message.
    </para>

    <para>
    Additionally the same conditions apply to the selection of the attributes
    and the "Fixed" checkbox as to the "X-axis" selection:
    </para>

    <para>
    <itemizedlist>
        <listitem>
            <para>
            If no attributes of the element are selected, all attributes are used,
            including those added after the configuration of the stat.
            </para>
        </listitem>
        <listitem>
            <para>
            If the "Fixed" setting is disabled, the agent generating the
            stat can change the attributes of the respective element.
            </para>
        </listitem>
    </itemizedlist>
    </para>
</listitem>
<listitem>
    <para>
        <emphasis>Definition of the restrictions to characterize the stat</emphasis>.
        It is the fourth and last step of the pre-configuration (see Figure 19.8 below).
        The restrictions facilitate to limit the results and are comparable to entering
        data into a search window. In quite a few cases, no restrictions at all must be set up.
    </para>

    <para>
    <screenshot>
    <screeninfo>Definition of restrictions</screeninfo>
    <graphic fileref="screenshots/stats-edit-restrictions.png" scale="40" srccredit="stats-edit-restrictions - Screenshot" />
    </screenshot>
    </para>

    <para>
        <emphasis>Figure 19.8. Definition of restrictions.</emphasis>
    </para>

    <para>
    After all restrictions are set, the pre-configuration of the stat is finished with
    the "Finish" button and the "View" user interface is called up.
    </para>
</listitem>
</orderedlist>
</para>
</section>

<section id="stats-import">
<title>Import</title>

<para>
The import user interface (see Figure 19.9 below) can be accessed by chosing "Import" in the
navigation bar (rw rights required).
</para>

<para>
<screenshot>
<screeninfo>The import user interface</screeninfo>
<graphic fileref="screenshots/stats-import.png" scale="40" srccredit="stats-import - Screenshot" />
</screenshot>
</para>

<para>
    <emphasis>Figure 19.9. The import user interface.</emphasis>
</para>

<para>
Facilitates the import of stats and is, combined with the export function
of the module, a very handy functionality. Stats can be created
and tested conveniently on test systems and then imported into the production
system.
</para>

<para>
The import is effected by an easy file upload. The "view" user
interface of the imported stat is opened automatically afterwards.
</para>
</section>

</section>

<section id="stats-managing-the-module">
<title>Administration of the stat module by the OTRS administrator</title>

<para>
This section provides information about the tasks and possibilities
of the OTRS administrator dealing with the statistics module.
</para>

<section id="stats-permissions" >
<title>Permission settings, groups and queues</title>

<para>
No new queues and/or groups are created when the stat module is
installed.
</para>

<para>
The default configuration of the module registration gives all agents with
"stats" group permissions access to the stats module.
</para>

<para>
Access according to permission settings:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
            <emphasis>rw</emphasis>.
            Allows configurating statistics.
        </para>
    </listitem>
    <listitem>
        <para>
            <emphasis>ro</emphasis>.
            Permits generating pre-configured statistics.
        </para>
    </listitem>
</itemizedlist>
</para>

<para>
The OTRS administrator decides whether agents with the permission to
generate pre-configured stats are allocated ro rights in the "stats" group, or
if their respective groups are added in the module registration in SysConfig.
</para>
</section>

<section id="stats-sysconfig" >
<title>SysConfig</title>

<para>
SysConfig groups

<link linkend="Framework:Core::Stats" >
Framework:Core::Stats
</link>

,

<link linkend="Framework:Core::Stats::Graph" >
Framework:Core::Stats::Graph
</link>and

<link linkend="Framework:Frontend::Agent::Stats" >
Framework:Frontend::Agent::Stats
</link>

contain all configuration parameters for the basic set-up of the statistics module.
Moreover, the configuration parameter

<link linkend="Framework:Frontend::Agent::ModuleRegistration:Frontend::Module_AgentStats" >
$Self-&gt;{'Frontend::Module'}-&gt;{'AgentStats'}
</link>

controls the arrangement and registration of the modules and icons within the
statistics module.
</para>
</section>

</section>

<section id="stats-managing-the-stats-module-by-the-sysadmin" >
<title>Administration of the stats module by the system administrator</title>

<para>
Generally, no system administrator is needed for the operation, configuration
and maintenance of the statistics module. However, a little background information
for the system administrator is given at this point.
</para>

<note>
<para>
File paths refer to subdirectories of the OTRS home
directory (in most cases<filename>/opt/otrs</filename>).
</para>
</note>

<section id="stats-db-table" >
<title>Data base table</title>

<para>
All stat configurations are implemented and administrated in XML and,
therefore, stored in the database table
"xml_storage". Other modules whose content is presented in xml
format use this table as well.
</para>

</section>

<section id="stats-filelist" >
<title>List of all files</title>

<para>
The following files are necessary for the stats module to work accurately:
</para>

<para>
<itemizedlist>
    <listitem>
        <para>
        <filename>Kernel/System/Stats.pm</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Modules/AgentStats.pm</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/System/CSV.pm</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsOverview.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsDelete.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsEditSpecification.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsEditRestrictions.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsEditXaxis.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsEditValueSeries.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsImport.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsPrint.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/Output/HTML/Standard/AgentStatsView.dtl</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>Kernel/System/Stats/Dynamic/Ticket.pm</filename>
        </para>
    </listitem>
    <listitem>
        <para>
        <filename>bin/mkStats.pl</filename>
        </para>
    </listitem>
</itemizedlist>
</para>
</section>

<section id="stats-caching" >
<title>Caching</title>

<para>
Whether the results of a statistic are to be cached or not can be defined in
the pre-configuration. Cached statistic results are stored as files in the
<filename>var/tmp</filename>directory of the OTRS
installation (in most cases<filename>/opt/otrs/var/tmp</filename>).
</para>

<para>
Cached stats can be recognized by the "Stats" prefix.
</para>

<para>
If the data is lost, no major damage is caused. The next time the
stat is called up, the stats module will not find the file any more
and thus, will generate a new stat, which will probably take
a little longer.
</para>
</section>

<section id="stats-mkstats" >
<title>mkStats.pl</title>

<para>
This file is saved in the <filename>bin/</filename>directory.
It facilitates the generation of stats in the command line.
</para>

<para>
The command line call in the Script 19.1 is an exemplary.
</para>

<para>
<programlisting>
bin> perl mkStats.pl -n 10004 -o /output/dir
</programlisting>
</para>

<para>
    <emphasis>Script 19.1. Generating a stat via command line.</emphasis>
</para>

<para>
A stat from the stat configuration "Stat# 10004" is generated and saved
as csv in the <filename>/output/dir</filename>directory.
</para>

<para>
The generated stat can also be sent as an e-mail.
More information can be called up with the command of the Script 19.2.
</para>

<para>
<programlisting>
bin> perl mkStats.pl --help
</programlisting>
</para>

<para>
    <emphasis>Script 19.2. Getting information about the mkStats.pl file.</emphasis>
</para>

</section>

<section id="stats-cron" >
<title>Automated stat generation - Cronjob</title>

<para>
It obviously does not really make sense to generate stats manually in
the command line, as the stat module has a convenient graphical user
interface. However, generating stats manually does make sense when
combined with a Cronjob.
</para>

<para>
Imagine the following scenario: On every first day of the month
the heads of department want to receive a stat for the past
month. By combining a cronjob and command line call the
stats can be sent to them automatically by e-mail.
</para>

</section>

<section id="stats-static" >
<title>Static stats</title>

<para>
The stats module facilitates the generation of static statistics. For every
static stat a file exists in which its content is precisely defined.
</para>

<para>
This way, very complex stats can be generated. The disadvantage
is that they are not particularly flexible.
</para>

<para>
The files are saved in the following directory
<filename>Kernel/System/Stats/Static/</filename>.
</para>
</section>

<section id="stats-using-old-stats" >
<title>Using old static stats</title>

<para>
Standard OTRS versions 1.3 and 2.0 already facilitated the generation of stats.
Various stats for OTRS versions 1.3 and 2.0 which have been specially
developed  to meet customers' requirements can be used in more recent versions too.
</para>

<para>The files must merely be moved from the
<filename>Kernel/System/Stats/</filename> path to
<filename>Kernel/System/Stats/Static/</filename>. Additionally
the package name of the respective script must be amended by
"::Static".
</para>

<para>
The following example shows how the first path is amended.
</para>

<para>
<programlisting>
    package Kernel::System::Stats::AccountedTime;
</programlisting>
</para>

<para>
<programlisting>
    package Kernel::System::Stats::Static::AccountedTime;
</programlisting>
</para>
</section>

<section id="stats-default-stats" >
<title>Default stats</title>

<para>"It is not always necessary to reinvent the wheel..."
</para>

<para>
The stats module provides various default stats. Stats which are
interesting for all OTRS users will in future be added to the default stats
of the stats module package. Default stats are saved in the stats module
xml format in the<filename>scripts/test/sample/</filename> directory.
</para>

</section>

</section>

</chapter>
