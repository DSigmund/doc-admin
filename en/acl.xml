<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<!-- $Id: acl.xml,v 1.6.2.4 2012-01-24 18:31:59 cr Exp $ --><chapter id="acl" >
<title>Access Control Lists (ACLs)</title>

<para>
From OTRS 2.0 on, Access Control Lists (ACLs) can be used to control access to tickets, modules, queues, etc., or to influence actions on tickets (closing, moving, etc.) in certain situations. ACLs can be used to supplement the existing permission system of <link linkend="adminarea-roles">roles</link> and <link linkend="adminarea-groups">groups
</link>. Using ACLs, rudimental workflows within the system can be mapped, based on ticket attributes.
</para>

<para>
As yet, ACLs cannot be created using the <link linkend="adminarea-sysconfig">SysConfig interface</link>. They must be directly entered into the <filename>Kernel/Config.pm</filename> file. Some ACL examples are listed below (Example 18-1, 18-2 and 18-3):
</para>

<para>
<example id="acl-move">
<title>ACL allowing movement into a queue of only those tickets with ticket priority 5.</title>

<programlisting>
    # ticket acl
    $Self->{TicketAcl}->{'ACL-Name-2'} = {
        # match properties
        Properties => {
            # current ticket match properties
            Ticket => {
                Queue => ['Raw'],
                Priority => ['5 very high'],
            }
        },
        # return possible options (white list)
        Possible => {
            # possible ticket options (white list)
            Ticket => {
                Queue => ['Alert'],
            },
        },
    };
</programlisting>
</example>
</para>

<para>
<example id="acl-close" >
<title>ACL disabling the closing of tickets in the raw queue, and hiding the close button.</title>

<programlisting>
    $Self->{TicketAcl}->{'ACL-Name-1'} = {
        # match properties
        Properties => {
            # current ticket match properties
            Ticket => {
                Queue => ['Raw'],
            }
        },
        # return possible options (white list)
        Possible => {
            # possible ticket options (white list)
            Ticket => {
                State => ['new', 'open', 'pending reminder'],
            },
            # possible action options
            Action => {
                AgentTicketBounce        => 1,
                AgentTicketClose         => 0,
                AgentTicketCompose       => 1,
                AgentTicketCustomer      => 1,
                AgentTicketForward       => 1,
                AgentTicketFreeText      => 1,
                AgentTicketHistory       => 1,
                AgentTicketLink          => 1,
                AgentTicketLock          => 1,
                AgentTicketMerge         => 1,
                AgentTicketMove          => 1,
                AgentTicketNote          => 1,
                AgentTicketOwner         => 1,
                AgentTicketPending       => 1,
                AgentTicketPhone         => 1,
                AgentTicketPhoneOutbound => 1,
                AgentTicketPrint         => 1,
                AgentTicketPriority      => 1,
                AgentTicketResponsible   => 1,
                AgentTicketWatcher       => 1,
                AgentTicketZoom          => 1,
                AgentLinkObject          => 1,
            },
        },
    };
</programlisting>
</example>
</para>

<para>
<example id="acl-state" >
<title>ACL removing the status for all agents, only providing it for a group.</title>

<programlisting>
    $Self->{TicketAcl}->{'ACL-Name-5'} = {
        # match properties
        Properties => {
            # current ticket match properties (match always)
        },
        # return possible options
        PossibleNot => {
            # possible ticket options
            Ticket => {
                State => ['closed successful'],
            },
        },
    };
</programlisting>
</example>
</para>

<para>
<example id="acl-new-ticket-service" >
<title>ACL only showing Hardware services for tickets that are created in queues that start with &quot;HW&quot;.</title>

<programlisting>
    $Self->{TicketAcl}->{'Only-Hardware-Services-for-HW-Queues'} = {
        # match properties
        # note we don't have "Ticket => {" because there's no ticket yet
        Properties => {
        Queue => {
            Name => ['[RegExp]HW'],
            }
        },
        # return possible options
        Possible => {
            # possible ticket options
            Ticket => {
                Service => ['[RegExp]^(Hardware)'],
            },
        },
    };
</programlisting>
</example>
</para>

<para>
In Script 18.1 there is a list of all parameters which can be used for ACLs.
</para>

<para>
<programlisting>
    # ticket acl
    $Self->{TicketAcl}->{'ACL-Name-Test'} = {
        # match properties
        Properties => {
            # current action match properties
            Frontend => {
                Action => ['AgentTicketPhone', 'AgentTicketEmail'],
            },
            # current user match properties
            User => {
                Group_rw => [
                    'hotline',
                ],
            },
            # current user match properties
            Ticket => {
                Queue => ['Raw'],
                State => ['new', 'open'],
                Priority => ['some priority'],
                Lock => ['lock'],
                CustomerID => ['some id'],
                CustomerUserID => ['some id'],
                TicketFreeKey1 => ['some key'],
                TicketFreeKey2 => ['some key'],
                # ...
                TicketFreeKey8 => ['some key'],
                TicketFreeText1 => ['some value'],
                TicketFreeText2 => ['some value'],
                # ...
                TicketFreeText8 => ['some value'],
            }
        },
        # return possible options (white list)
        Possible => {
            # possible ticket options (white list)
            Ticket => {
                Queue => ['Hotline', 'Coordination'],
                State => ['some state'],
                Priority => ['5 very high'],
                TicketFreeKey1 => ['some key'],
                TicketFreeKey2 => ['some key'],
                # ...
                TicketFreeKey8 => ['some key'],
                TicketFreeText1 => ['some value'],
                TicketFreeText2 => ['some value'],
                # ...
                TicketFreeText8 => ['some value'],
            },
            # possible action options (white list)
            Action => {
                AgentTicketBounce        => 1,
                AgentTicketClose         => 1,
                AgentTicketCompose       => 1,
                AgentTicketCustomer      => 1,
                AgentTicketForward       => 1,
                AgentTicketFreeText      => 0,
                AgentTicketHistory       => 0,
                AgentTicketLink          => 1,
                AgentTicketLock          => 1,
                AgentTicketMerge         => 1,
                AgentTicketMove          => 1,
                AgentTicketNote          => 1,
                AgentTicketOwner         => 0,
                AgentTicketPending       => 0,
                AgentTicketPhone         => 1,
                AgentTicketPhoneOutbound => 1,
                AgentTicketPrint         => 0,
                AgentTicketPriority      => 1,
                AgentTicketResponsible   => 1,
                AgentTicketWatcher       => 1,
                AgentTicketZoom          => 1,
                AgentLinkObject          => 1,
            },
        },
        # remove options (black list)
        PossibleNot => {
            # possible ticket options (black list)
            Ticket => {
                Queue => ['Hotline', 'Coordination'],
                State => ['closed', 'removed'],
            },
        },
    };
</programlisting>
</para>

<para>
<emphasis>Script 18.1. Valid parameters for ACLs.</emphasis>
</para>

</chapter>