<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
  "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">

<section id="updating">
    <title>Updating OTRS</title>

    <note>
        <para>
            Nagyon ajánlott először egy próbafrissítést végrehajtani egy elkülönített
tesztelési gépen.
        </para>
    </note>

    <variablelist>
        <varlistentry>
            <term>Updating from an earlier version of OTRS 6</term>
            <listitem>
                <para>
                    You can update directly from any previous to the latest available patch
level release.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term>Updating from OTRS 5</term>
            <listitem>
                <para>
                    You can update from any OTRS 5 patch level to the latest available OTRS 6
patch level release.
                </para>
            </listitem>
        </varlistentry>
        <varlistentry>
            <term>Updating from OTRS 4 or earlier</term>
            <listitem>
                <warning>
                    <para>
                        You cannot update from OTRS 4 or earlier directly to OTRS 6.  Instead, full
updates to all available minor versions have to be made sequentially
instead.  For example, if you come from OTRS 3.0, you first have to perform
a full update to OTRS 3.1, then to 3.2, 3.3, 4, 5 and finally to OTRS 6.
                    </para>
                </warning>
            </listitem>
        </varlistentry>
    </variablelist>

    <section role="NotInToc">
        <title>1. lépés: az összes kapcsolódó szolgáltatás és az OTRS démon leállítása</title>

        <para>
        Győződjön meg arról, hogy nincs-e több olyan futó szolgáltatás vagy
cron-feladat, amely megpróbál hozzáférni az OTRS-hez. Ez a szolgáltatás
beállításától fog függeni. Itt egy példa:
        </para>

        <para>
            <screen><![CDATA[
root> /etc/init.d/cron stop
root> /etc/init.d/postfix stop
root> /etc/init.d/apache stop
            ]]></screen>
        </para>

        <para>
        Állítsa le az OTRS cron-feladatait és a démont (ebben a sorrendben):
        </para>

        <para>
            <screen><![CDATA[
otrs> cd /opt/otrs/
otrs> bin/Cron.sh stop
otrs> bin/otrs.Daemon.pl stop
            ]]></screen>
        </para>
    </section>

    <section role="NotInToc">
        <title>2. lépés: a fájlok és az adatbázis biztonsági mentése</title>

        <para>
            <itemizedlist>
                <listitem><para><filename>Kernel/Config.pm</filename></para></listitem>
                <listitem>
                    <para><filename>Kernel/Config/Files/ZZZAuto.pm</filename>, if updating from OTRS 5</para>
                </listitem>
                <listitem><para><filename>var/*</filename></para></listitem>
                <listitem><para>valamint az adatbázis</para></listitem>
            </itemizedlist>
        </para>
        <warning>
            <para>Ne folytassa a rendszer teljes biztonsági mentse nélkül!</para>
        </warning>
    </section>

    <section role="NotInToc">
    <title>3. lépés: az új kiadás telepítés (tar vagy RPM)</title>

        <section role="NotInToc">
        <title>3.1. lépés: tarball segítségével:</title>

            <screen><![CDATA[
root> cd /opt
root> mv otrs otrs-old
root> tar -xzf otrs-x.x.x.tar.gz
root> mv otrs-x.x.x otrs
            ]]></screen>

            <section role="NotInToc">
            <title>Régi beállítófájlok visszaállítása</title>

                <para>
                    <itemizedlist>
                        <listitem><para><filename>Kernel/Config.pm</filename></para></listitem>
                        <listitem>
                            <para><filename>Kernel/Config/Files/ZZZAuto.pm</filename>, if updating from OTRS 5</para>
                        </listitem>
                    </itemizedlist>
                </para>
            </section>

            <section role="NotInToc">
                <title>Bejegyzésadatok visszaállítása</title>

                <para>
                    If you configured OTRS to store article data in the filesystem you have to
restore the <filename>article</filename> folder to
<filename>/opt/otrs/var/</filename> or the folder specified in the System
Configuration.
                </para>
            </section>


            <section role="NotInToc">
                <title>A már telepített alapértelmezett statisztikák visszaállítása</title>

                <para>
                    Ha alapértelmezett statisztikákkal rendelkező további csomagjai vannak,
akkor vissza kell állítania a statisztikák XML-fájljait az
<filename>*.installed</filename> utótaggal az
<filename>/opt/otrs/var/stats</filename> mappába.
                </para>
                <screen><![CDATA[
root> cd OTRS-BACKUP/var/stats
root> cp *.installed /opt/otrs/var/stats
                ]]></screen>
            </section>

            <section role="NotInToc">
                <title>Fájljogosultságok beállítása</title>

                <para>
                    Hajtsa végre a következő parancsot root felhasználóként az OTRS fájl- és
könyvtárjogosultságainak beállításához. Megpróbálja felismerni a
beállításhoz szükséges helyes felhasználó- és csoportbeállításokat.
                </para>

                <para>
                <screen><![CDATA[
root> cd /opt/otrs/
root> bin/otrs.SetPermissions.pl
                ]]></screen>
                </para>
            </section>
        </section>

        <section role="NotInToc">
            <title>3.2. lépés: RPM segítségével:</title>
            <para>
            <screen><![CDATA[
root> rpm -Uvh otrs-x.x.x.-01.rpm
            ]]></screen>
            </para>
            <para>
                Ebben az esetben az RPM frissítés automatikusan visszaállítja a régi
beállítófájlokat és beállítja a fájljogosultságokat.
            </para>
        </section>
    </section>

    <section role="NotInToc">
        <title>4. lépés: a költöztető parancsfájl futtatása</title>

        <note>
            <para>
                If you have any custom Perl or XML configuration files in
<filename>Kernel/Config/Files</filename>, these need to be <ulink
url="http://doc.otrs.com/doc/manual/developer/6.0/en/html/package-porting.html#packge-porting-5-to-6-configuration-files">converted
to the new formats supported by OTRS 6</ulink> before running the migration
script.
            </para>
        </note>

        <para>
            The migration script will perform many checks on your system and give you
advice on how to install missing Perl modules etc., if that is required. If
all checks succeeded, the neccessary migration steps will be
performed. Please also run this script in case of patch level updates.
        </para>

        <note>
            <para>
                The migration script will ask you to set a time zone for OTRS if needed. It
is very important that you set the correct time zone
(<literal>OTRSTimeZone</literal>) for data storage and keep it, otherwise
date and time of data added after the update (tickets, articles, etc.) will
be stored with a different time zone than your pre-existing data, leading to
inconsistent output.
            </para>
            <para>
                For new systems, using <literal>UTC</literal> is recommended, as users can
have different personal time zones for working with the OTRS
application. For existing, migrated systems, a different
<literal>OTRSTimeZone</literal> should be used if the underlying operating
system is not configured to <literal>UTC</literal> or if OTRS previously
used a time offset.
            </para>
        </note>

        <para>
            Futtassa le a költöztető parancsfájlt (<literal>otrs</literal>
felhasználóként, NE <literal>root</literal> felhasználóként):
        </para>

        <para>
        <screen><![CDATA[
otrs> cd /opt/otrs/
otrs> scripts/DBUpdate-to-6.pl
        ]]></screen>
        </para>

        <warning>
            <para>
                Ne folytassa a frissítési folyamatot, ha ez a parancsfájl nem működött
megfelelően önnél. Egyébként meghibásodás vagy adatvesztés fordulhat elő.
            </para>
        </warning>
    </section>

    <section role="NotInToc">
        <title>Step 5: Update installed packages</title>
        <note>
            <para>
                Az OTRS 5 csomagjai nem kompatibilisek az OTRS 6-os verzióval, és frissíteni
kell azokat.
            </para>
        </note>
        <para>
            You can use the command below to update all installed packages.  This works
for all packages that are available from online repositories.  You can
update other packages later via the package manager (this requires a running
OTRS Daemon).
        </para>
        <screen><![CDATA[
otrs> cd /opt/otrs/
otrs> bin/otrs.Console.pl Admin::Package::UpgradeAll
        ]]></screen>
    </section>

    <section role="NotInToc">
        <title>Step 6: Restart your services</title>

        <para>
            Ez a szolgáltatás beállításától fog függeni. Itt egy példa:
        </para>

        <para>
        <screen><![CDATA[
root> /etc/init.d/apache start
root> /etc/init.d/postfix start
root> /etc/init.d/cron start
        ]]></screen>
        </para>

        <note>
            <para>
                The OTRS Daemon is required for correct operation of OTRS such as sending
emails.  Please activate it as described in the next step.
            </para>
        </note>
    </section>

    <section role="NotInToc">
        <title>7. lépés: az OTRS démon és a cron-feladat elindítása</title>

        <para>
            The OTRS Daemon is responsible for handling any asynchronous and recurring
tasks in OTRS.  The daemon and its keepalive cron job must be started as the
<literal>otrs</literal> user.
        </para>

        <para>
            <screen><![CDATA[
otrs> cd /opt/otrs/
otrs> bin/otrs.Daemon.pl start
otrs> bin/Cron.sh start
            ]]></screen>
        </para>
        <para>
            Most már bejelentkezhet a rendszerre.
        </para>
    </section>

</section>
